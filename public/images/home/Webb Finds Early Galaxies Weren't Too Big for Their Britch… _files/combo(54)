YUI.add("fluid-avatar-editor-view",(function(t){"use strict";var o={dragging:{mouseDownX:0,mouseDownY:0,previousX:0,previousY:0,centerX:0,centerY:0,startDrag:!1,overlayDiameter:0},zoom:{scale:1,scaleFactor:1,mouseDownX:0,previousX:0,startDrag:!1,midpoint:0,height:0,width:0,max:0,min:0,isLowQuality:!1},potential:{height:0,width:0,url:"",x:0,y:0},original:{x:0,y:0}},e=.25;t.FlickrView.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.set("photoModel",t.photoModel),this.contentHeight=t.contentHeight,o.zoom.scale=1,o.dragging.startDrag=!1,o.zoom.startDrag=!1,this},loadState:function(){return t.Promise.resolve()},buildContainer:function(t){return this.setContainerWithTemplate("fluid-avatar-editor",{contentHeight:this.contentHeight}),this},activate:function(){return this.avatarBackground=this.get("container").one(".avatar-background"),this.avatarFocus=this.get("container").one(".avatar-image"),this.zoomHandle=this.get("container").one(".zoom-handle"),this.containerWidth=this.get("container").get("offsetWidth"),this.containerHeight=this.get("container").get("offsetHeight"),this.loadAvatarPhoto(),this},showTooltip:function(){this.zoomTooltip||(this.zoomTooltip=new t.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!1,dismissOnActionClick:!1,showDropArrow:!0,width:150,anchorElement:this.zoomHandle,textMessage:this.intlMessage({intlName:"header.MIN_ZOOM"}),invisibleOverlay:!0,classList:"over-modal",overlayClassList:"over-modal"})),this.zoomTooltip.show()},hideTooltip:function(){this.zoomTooltip&&!this.zoomTooltip.isClosed&&this.zoomTooltip.close()},loadAvatarPhoto:function(){var t,e=new Image;e.onload=this.handleImageLoad.bind(this),t=this.get("photoModel").getLargestSize(),o.potential.width=t.width,o.potential.height=t.height,o.potential.url=t.url,o.zoom.width=t.width*o.zoom.scale,o.zoom.height=t.height*o.zoom.scale,e.src=t.url,(e.complete||e.onloadFired)&&this.handleImageLoad()},handleImageLoad:function(){var t=this.get("container"),e=t.one(".avatar-clip");o.dragging.centerX=-1*(o.potential.width/2-this.containerWidth/2),o.dragging.centerY=-1*(o.potential.height/2-this.containerHeight/2),o.dragging.overlayDiameter=parseInt(e.getStyle("width"),10)/2,this.offsetLeft=this.containerWidth/2-o.dragging.overlayDiameter,this.offsetTop=this.containerHeight/2-o.dragging.overlayDiameter,o.potential.x=o.dragging.centerX,o.potential.y=o.dragging.centerY,o.original.x=o.dragging.centerX,o.original.y=o.dragging.centerY,this.saveParamsForAPI(),t.one(".avatar-image").setStyles({backgroundImage:"url("+o.potential.url+")",width:o.potential.width+"px",height:o.potential.height+"px",left:o.dragging.centerX+-1*this.offsetLeft+"px",top:o.dragging.centerY+-1*this.offsetTop+"px"}),t.one(".avatar-background").setStyles({backgroundImage:"url("+o.potential.url+")",width:o.potential.width+"px",height:o.potential.height+"px",left:o.dragging.centerX+"px",top:o.dragging.centerY+"px"}),this.setupEventListeners(),this.setupZoomHandler()},setupEventListeners:function(){var e=this.get("container"),i=e.one(".avatar-background"),a=e.one(".avatar-image"),n=e.one(".controls-area"),r=this;this.registerEventHandler(i.on(["mousedown","touchstart"],(function(t){t.halt(),o.dragging.mouseDownY=t.pageY||(t.touches&&t.touches.length?t.touches[0].pageY:0),o.dragging.mouseDownX=t.pageX||(t.touches&&t.touches.length?t.touches[0].pageX:0),o.dragging.previousY=parseInt(i.getStyle("top"),10),o.dragging.previousX=parseInt(i.getStyle("left"),10),o.dragging.startDrag=!0,i.addClass("grabbing"),n.addClass("clickthrough")}))),this.registerEventHandler(i.on(["mousemove","touchmove"],(function(t){if(t.halt(),o.dragging.startDrag){var e=o.dragging.mouseDownY-(t.pageY||(t.touches&&t.touches.length?t.touches[0].pageY:0)),n=o.dragging.mouseDownX-(t.pageX||(t.touches&&t.touches.length?t.touches[0].pageX:0)),s=o.dragging.previousY-e,g=o.dragging.previousX-n,h=r.snapFocusToFit(g,s);g=h.x,s=h.y,o.potential.x=g,o.potential.y=s,o.original.x=(r.containerWidth-r.containerWidth/o.zoom.scale)/2+o.potential.x/o.zoom.scale,o.original.y=(r.containerHeight-r.containerHeight/o.zoom.scale)/2+o.potential.y/o.zoom.scale,r.saveParamsForAPI(),i.setStyle("left",g),i.setStyle("top",s),a.setStyle("left",g+-1*r.offsetLeft),a.setStyle("top",s+-1*r.offsetTop)}}))),this.registerEventHandler(t.one("body").on(["mouseup","touchend"],(function(){o.dragging.startDrag=!1,i.removeClass("grabbing"),n.removeClass("clickthrough")}))),this.registerEventHandler(i.on(["mouseup","touchend"],(function(){o.dragging.startDrag=!1,i.removeClass("grabbing"),n.removeClass("clickthrough")})))},determineBoundaries:function(){return{minX:o.dragging.centerX+o.zoom.width/2-o.dragging.overlayDiameter,minY:o.dragging.centerY+o.zoom.height/2-o.dragging.overlayDiameter,maxX:o.dragging.centerX-o.zoom.width/2+o.dragging.overlayDiameter,maxY:o.dragging.centerY-o.zoom.height/2+o.dragging.overlayDiameter}},snapFocusToFit:function(t,o){var e=this.determineBoundaries();return{x:t=(t=t<=e.minX?t:e.minX)>=e.maxX?t:e.maxX,y:o=(o=o<=e.minY?o:e.minY)>=e.maxY?o:e.maxY}},setupZoomHandler:function(){var i,a=this,n=this.get("container"),r=n.one(".controls-area"),s=n.one(".zoom-controls"),g=n.one(".zoom-plus"),h=n.one(".zoom-minus");o.zoom.max=parseInt(s.get("offsetWidth"),10)-parseInt(this.zoomHandle.get("offsetWidth"),10),o.zoom.previousX=parseInt(this.zoomHandle.getStyle("left"),10),o.zoom.scaleFactor=1/(o.zoom.max/4),o.zoom.midpoint=o.zoom.max/2,i=Math.max(2*o.dragging.overlayDiameter/o.potential.width,2*o.dragging.overlayDiameter/o.potential.height),o.zoom.min=2*(i-e)/o.zoom.scaleFactor,o.zoom.min>o.zoom.max&&(o.zoom.isLowQuality=!0,this.zoomHandle.setStyle("left",o.zoom.max)),n.one(".low-quality-zone").setStyle("width",Math.min(o.zoom.min,o.zoom.max)),o.zoom.scale=Math.max(o.zoom.min,o.zoom.midpoint)*o.zoom.scaleFactor/2+e,this.updateImageScale(),this.registerEventHandler(this.zoomHandle.on(["mousedown","touchstart"],this.onZoomBarClicked.bind(this))),this.registerEventHandler(r.on(["mousemove","touchmove"],this.onZoomBarMoved.bind(this))),this.registerEventHandler(g.on("click",this.zoomByIncrement.bind(this))),this.registerEventHandler(h.on("click",this.zoomByIncrement.bind(this))),this.registerEventHandler(n.on(["mouseup","touchend"],(function(t){t.halt(),o.zoom.startDrag=!1,a.zoomHandle.removeClass("dragging")}))),this.registerEventHandler(t.one("body").on(["mouseup","touchend"],(function(t){o.zoom.startDrag=!1,a.zoomHandle.removeClass("dragging")})))},onZoomBarClicked:function(t){t.halt(),o.zoom.mouseDownX=t.pageX||(t.touches&&t.touches.length?t.touches[0].pageX:0),o.zoom.startDrag=!0,o.zoom.previousX=parseInt(this.zoomHandle.getStyle("left"),10),this.zoomHandle.addClass("dragging")},onZoomBarMoved:function(t){if(t.halt(),o.zoom.startDrag){var i=o.zoom.mouseDownX-(t.pageX||(t.touches&&t.touches.length?t.touches[0].pageX:0)),a=o.zoom.previousX-i;a=(a=a<=o.zoom.min?o.zoom.min:a)>=o.zoom.max?o.zoom.max:a,o.zoom.scale=a*o.zoom.scaleFactor/2+e,a<=o.zoom.min&&o.zoom.isLowQuality?this.showTooltip():(a===o.zoom.min?this.showTooltip():this.hideTooltip(),this.zoomHandle.setStyle("left",a),this.updateImageScale())}},zoomByIncrement:function(t){var i,a=parseInt(this.zoomHandle.getStyle("left"));t&&(t.halt(),t.target.hasClass("zoom-plus")?i=a+parseInt(o.zoom.max/10):t.target.hasClass("zoom-minus")&&(i=a-parseInt(o.zoom.max/10)),(i=(i=i<=o.zoom.min?o.zoom.min:i)>=o.zoom.max?o.zoom.max:i)<=o.zoom.min&&o.zoom.isLowQuality?this.showTooltip():(i===o.zoom.min?this.showTooltip():this.hideTooltip(),o.zoom.previousX=i,o.zoom.scale=i*o.zoom.scaleFactor/2+e,this.zoomHandle.setStyle("left",i),this.updateImageScale()))},updateImageScale:function(){var t,e,i;o.zoom.width=o.potential.width*o.zoom.scale,o.zoom.height=o.potential.height*o.zoom.scale,o.dragging.centerX=-1*(o.zoom.width/2-this.containerWidth/2),o.dragging.centerY=-1*(o.zoom.height/2-this.containerHeight/2),t=(this.containerWidth-this.containerWidth*o.zoom.scale)/2+o.original.x*o.zoom.scale,e=(this.containerHeight-this.containerHeight*o.zoom.scale)/2+o.original.y*o.zoom.scale,t=(i=this.snapFocusToFit(t,e)).x,e=i.y,o.potential.x=t,o.potential.y=e,this.saveParamsForAPI(),this.avatarBackground.setStyles({width:o.zoom.width+"px",height:o.zoom.height+"px",left:t+"px",top:e+"px"}),this.avatarFocus.setStyles({width:o.zoom.width+"px",height:o.zoom.height+"px",left:t+-1*this.offsetLeft+"px",top:e+-1*this.offsetTop+"px"})},saveParamsForAPI:function(){var e=o.zoom.width/2-(o.potential.x-o.dragging.centerX),i=o.zoom.height/2-(o.potential.y-o.dragging.centerY);e/=o.zoom.scale,i/=o.zoom.scale,this.set("apiParams",{x1:parseInt(e-o.dragging.overlayDiameter/o.zoom.scale),x2:parseInt(e+o.dragging.overlayDiameter/o.zoom.scale),y1:parseInt(i-o.dragging.overlayDiameter/o.zoom.scale),y2:parseInt(i+o.dragging.overlayDiameter/o.zoom.scale),url:t.URLHelper.addProtocolToURL(o.potential.url)})},destructor:function(){return this.hideTooltip(),this.constructor.superclass.destroy.call(this)}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-fluid-avatar-editor","url-helper","fluid-droparound-view"],langBundles:["header"]});YUI.add("hermes-template-coverphoto-context-menu",(function(n,t){var l=n.Template.Handlebars.revive({1:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t<div class="follow-options">\n\t\t\t<div class="mark-as-heading">'+n.escapeExpression((a(l,"intlMessage")||t&&a(t,"intlMessage")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},{name:"intlMessage",hash:{intlName:"header.MARK_AS_LABEL"},data:o,loc:{start:{line:4,column:32},end:{line:4,column:80}}}))+'</div>\n\t\t\t<div class="toggle-container friend-toggle-container"></div>\n\t\t\t<div class="toggle-container family-toggle-container"></div>\n\t\t</div>\n'},3:function(n,t,l,e,o){var a,r=null!=t?t:n.nullContext||{},i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return(null!=(a=i(l,"if").call(r,null!=t?i(t,"canEditCoverPhoto"):t,{name:"if",hash:{},fn:n.program(4,o,0),inverse:n.noop,data:o,loc:{start:{line:13,column:3},end:{line:15,column:10}}}))?a:"")+(null!=(a=i(l,"if").call(r,null!=t?i(t,"showHideFromFeed"):t,{name:"if",hash:{},fn:n.program(6,o,0),inverse:n.noop,data:o,loc:{start:{line:16,column:3},end:{line:22,column:10}}}))?a:"")+(null!=(a=i(l,"if").call(r,null!=t?i(t,"showMute"):t,{name:"if",hash:{},fn:n.program(11,o,0),inverse:n.noop,data:o,loc:{start:{line:23,column:3},end:{line:29,column:10}}}))?a:"")+(null!=(a=i(l,"if").call(r,null!=t?i(t,"canReport"):t,{name:"if",hash:{},fn:n.program(16,o,0),inverse:n.noop,data:o,loc:{start:{line:30,column:3},end:{line:32,column:10}}}))?a:"")+"\n"},4:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t<li class="context-item" data-id="change-coverphoto">'+n.escapeExpression((a(l,"intlMessage")||t&&a(t,"intlMessage")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},{name:"intlMessage",hash:{intlName:"common.CHANGE_COVER_PHOTO"},data:o,loc:{start:{line:14,column:57},end:{line:14,column:110}}}))+"</li>\n"},6:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(a=r(l,"if").call(null!=t?t:n.nullContext||{},null!=t?r(t,"isHiddenFromFeed"):t,{name:"if",hash:{},fn:n.program(7,o,0),inverse:n.program(9,o,0),data:o,loc:{start:{line:17,column:4},end:{line:21,column:11}}}))?a:""},7:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t\t<li class="context-item" data-id="show-in-feed">'+n.escapeExpression((a(l,"intlMessage")||t&&a(t,"intlMessage")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},{name:"intlMessage",hash:{intlName:"groups.SHOW_GROUP_FEED"},data:o,loc:{start:{line:18,column:53},end:{line:18,column:103}}}))+"</li>\n"},9:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t\t<li class="context-item" data-id="hide-from-feed">'+n.escapeExpression((a(l,"intlMessage")||t&&a(t,"intlMessage")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},{name:"intlMessage",hash:{intlName:"groups.HIDE_GROUP_FEED"},data:o,loc:{start:{line:20,column:55},end:{line:20,column:105}}}))+"</li>\n"},11:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(a=r(l,"if").call(null!=t?t:n.nullContext||{},null!=t?r(t,"isMuted"):t,{name:"if",hash:{},fn:n.program(12,o,0),inverse:n.program(14,o,0),data:o,loc:{start:{line:24,column:4},end:{line:28,column:11}}}))?a:""},12:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t\t<li class="context-item" data-id="unmute-notifications">'+n.escapeExpression((a(l,"intlMessage")||t&&a(t,"intlMessage")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},{name:"intlMessage",hash:{intlName:"groups.UNMUTE_NOTIFICATIONS"},data:o,loc:{start:{line:25,column:61},end:{line:25,column:116}}}))+"</li>\n"},14:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t\t<li class="context-item" data-id="mute-notifications">'+n.escapeExpression((a(l,"intlMessage")||t&&a(t,"intlMessage")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},{name:"intlMessage",hash:{intlName:"groups.MUTE_NOTIFICATIONS"},data:o,loc:{start:{line:27,column:59},end:{line:27,column:112}}}))+"</li>\n"},16:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t<li class="context-item" data-id="report">'+n.escapeExpression((a(l,"intlMessage")||t&&a(t,"intlMessage")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},{name:"intlMessage",hash:{intlName:"common.REPORT_ABUSE"},data:o,loc:{start:{line:31,column:46},end:{line:31,column:93}}}))+"</li>\n"},18:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return(null!=(a=r(l,"if").call(null!=t?t:n.nullContext||{},null!=t?r(t,"viewingSelf"):t,{name:"if",hash:{},fn:n.program(19,o,0),inverse:n.program(22,o,0),data:o,loc:{start:{line:36,column:3},end:{line:64,column:10}}}))?a:"")+"\t\t\t\n"},19:function(n,t,l,e,o){var a,r=null!=t?t:n.nullContext||{},i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return(null!=(a=i(l,"if").call(r,null!=t?i(t,"canEditCoverPhoto"):t,{name:"if",hash:{},fn:n.program(20,o,0),inverse:n.noop,data:o,loc:{start:{line:37,column:4},end:{line:39,column:11}}}))?a:"")+'\t\t\t\t<li class="context-item" data-id="edit-profile-info">'+n.escapeExpression((i(l,"intlMessage")||t&&i(t,"intlMessage")||n.hooks.helperMissing).call(r,{name:"intlMessage",hash:{intlName:"profile.EDIT_PROFILE_INFO"},data:o,loc:{start:{line:40,column:57},end:{line:40,column:110}}}))+"</li>\n"},20:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t\t<li class="context-item" data-id="change-coverphoto">'+n.escapeExpression((a(l,"intlMessage")||t&&a(t,"intlMessage")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},{name:"intlMessage",hash:{intlName:"common.CHANGE_COVER_PHOTO"},data:o,loc:{start:{line:38,column:58},end:{line:38,column:111}}}))+"</li>\n"},22:function(n,t,l,e,o){var a,r=null!=t?t:n.nullContext||{},i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return(null!=(a=i(l,"if").call(r,null!=t?i(t,"showGiftPro"):t,{name:"if",hash:{},fn:n.program(23,o,0),inverse:n.noop,data:o,loc:{start:{line:42,column:4},end:{line:46,column:11}}}))?a:"")+(null!=(a=i(l,"if").call(r,null!=t?i(t,"isBlocked"):t,{name:"if",hash:{},fn:n.noop,inverse:n.program(25,o,0),data:o,loc:{start:{line:47,column:4},end:{line:53,column:11}}}))?a:"")+(null!=(a=i(l,"if").call(r,null!=t?i(t,"showBlock"):t,{name:"if",hash:{},fn:n.program(28,o,0),inverse:n.noop,data:o,loc:{start:{line:54,column:4},end:{line:60,column:11}}}))?a:"")+(null!=(a=i(l,"if").call(r,null!=t?i(t,"canReport"):t,{name:"if",hash:{},fn:n.program(33,o,0),inverse:n.noop,data:o,loc:{start:{line:61,column:4},end:{line:63,column:11}}}))?a:"")},23:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t\t<li class="context-item" data-id="gift-pro">\n\t\t\t\t\t\t'+n.escapeExpression((a(l,"outlet")||t&&a(t,"outlet")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},null!=t?a(t,"gift-pro-view"):t,{name:"outlet",hash:{},data:o,loc:{start:{line:44,column:6},end:{line:44,column:30}}}))+"\n\t\t\t\t\t</li>\n"},25:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(a=r(l,"if").call(null!=t?t:n.nullContext||{},null!=t?r(t,"isBlockedBy"):t,{name:"if",hash:{},fn:n.noop,inverse:n.program(26,o,0),data:o,loc:{start:{line:48,column:5},end:{line:52,column:12}}}))?a:""},26:function(n,t,l,e,o){var a,r=null!=t?t:n.nullContext||{},i=n.hooks.helperMissing,s=n.escapeExpression,c=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t\t\t<li class="context-item link" data-id="send-message">\n\t\t\t\t\t\t\t<a href="'+s("function"==typeof(a=null!=(a=c(l,"flickrMailUrl")||(null!=t?c(t,"flickrMailUrl"):t))?a:i)?a.call(r,{name:"flickrMailUrl",hash:{},data:o,loc:{start:{line:50,column:16},end:{line:50,column:33}}}):a)+'">'+s((c(l,"intlMessage")||t&&c(t,"intlMessage")||i).call(r,{name:"intlMessage",hash:{intlName:"photo-card.SEND_A_MESSAGE"},data:o,loc:{start:{line:50,column:35},end:{line:50,column:88}}}))+"</a>\n\t\t\t\t\t\t</li>\n"},28:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(a=r(l,"if").call(null!=t?t:n.nullContext||{},null!=t?r(t,"isBlocked"):t,{name:"if",hash:{},fn:n.program(29,o,0),inverse:n.program(31,o,0),data:o,loc:{start:{line:55,column:5},end:{line:59,column:12}}}))?a:""},29:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t\t\t<li class="context-item" data-id="unblock">'+n.escapeExpression((a(l,"intlHTMLMessage")||t&&a(t,"intlHTMLMessage")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},{name:"intlHTMLMessage",hash:{username:null!=t?a(t,"displayname"):t,intlName:"photo-card.UNBLOCK_USER"},data:o,loc:{start:{line:56,column:49},end:{line:56,column:125}}}))+"</li>\n"},31:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t\t\t<li class="context-item" data-id="block">'+n.escapeExpression((a(l,"intlHTMLMessage")||t&&a(t,"intlHTMLMessage")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},{name:"intlHTMLMessage",hash:{intlName:"profile.BLOCK_USER"},data:o,loc:{start:{line:58,column:47},end:{line:58,column:97}}}))+"</li>\n"},33:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t\t<li class="context-item" data-id="report">'+n.escapeExpression((a(l,"intlMessage")||t&&a(t,"intlMessage")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},{name:"intlMessage",hash:{intlName:"profile.REPORT_USER"},data:o,loc:{start:{line:62,column:47},end:{line:62,column:94}}}))+"</li>\n"},compiler:[8,">= 4.3.0"],main:function(n,t,l,e,o){var a,r=null!=t?t:n.nullContext||{},i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'<div class="coverphoto-context-menu">\n'+(null!=(a=i(l,"if").call(r,null!=t?i(t,"isFollowing"):t,{name:"if",hash:{},fn:n.program(1,o,0),inverse:n.noop,data:o,loc:{start:{line:2,column:1},end:{line:8,column:8}}}))?a:"")+'\n\t<ul class="context-list">\n'+(null!=(a=i(l,"if").call(r,null!=t?i(t,"isGroup"):t,{name:"if",hash:{},fn:n.program(3,o,0),inverse:n.program(18,o,0),data:o,loc:{start:{line:11,column:2},end:{line:66,column:9}}}))?a:"")+"\t</ul>\n</div>\n"},useData:!0}),e={};n.Array.each([],(function(t){var l=n.Template.get("hermes/"+t);l&&(e[t]=l)})),n.Template.register("hermes/coverphoto-context-menu",(function(t,o){return(o=o||{}).partials=o.partials?n.merge(e,o.partials):e,l(t,o)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("coverphoto-context-menu-view",(function(e,i){"use strict";var t=require("hermes-core/flog")(i);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(i){var t;return i.recipientNsid=i.pageNsid,this.params=i,this.params.isPersonPro=!!this.params.personModel&&this.params.personModel.getValue("isPro"),this.params.isFollowing=!!this.params.relationshipModel&&this.params.relationshipModel.getValue("isContact"),this.params.personModel&&(t=e.URLHelper.generatePersonUrls(this.params.personModel),this.params.flickrMailUrl=t.sendFlickrMail,this.params.displayname=this.params.personModel.getValue("displayname")),this},subviewConfig:{"gift-pro-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,placement:"context-menu",disabled:function(e){return!this.appContext.flipper.isFlipped("enable-gift-pro")||e.isGroup}}},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("flickr-balls"),this},activate:function(){var i=this,t=this.get("container"),r=[];return t.addClass("loading"),i.params.isGroup&&(r.push(this.appContext.getModel("person-preferences-models",this.appContext.getViewer().nsid).then((function(t){return t?t.remoteReadUserPrefs({object_type:1},i.appContext):e.Promise.resolve()})).then((function(t){if(t&&t.userFeedPref){var r=t.userFeedPref.filter((function(e){return e.objectId===i.params.groupId}));i.isHiddenFromFeed=r.length>0&&"0"===r[0].prefValue}return e.Promise.resolve()}))),r.push(this.params.groupStatusHelper.load().then((function(){i.params.groupStatusHelper.update()})))),e.Promise.all(r).then((function(e){var r={};if(i.params.isGroup){var o=i.params.groupStatusHelper.getInfo();r={isGroup:!0,isHiddenFromFeed:i.isHiddenFromFeed,isMuted:o.groupAttrs.muted,canReport:!0,showHideFromFeed:o.groupAttrs.isMember,showMute:o.groupAttrs.isMember,canEditCoverPhoto:i.params.canEditCoverPhoto}}else r={isPersonPro:i.params.isPersonPro,isFollowing:i.params.isFollowing,flickrMailUrl:i.params.flickrMailUrl,isHiddenFromFeed:i.isHiddenFromFeed,canEditCoverPhoto:i.params.canEditCoverPhoto,viewingSelf:i.params.viewingSelf,showGiftPro:i.params.personModel.getValue("isEligibleForGifts"),isBlocked:!!i.params.relationshipModel&&i.params.relationshipModel.getValue("isIgnored"),isBlockedBy:!!i.params.relationshipModel&&i.params.relationshipModel.getValue("isIgnoredBy"),canReport:!0,displayname:i.params.displayname,showBlock:i.appContext.getViewer().signedIn};return i.setContainerWithTemplate("coverphoto-context-menu",r),i.friendToggleNode=t.one(".friend-toggle-container"),i.familyToggleNode=t.one(".family-toggle-container"),i.getSubviews()})).then((function(){return i.insertSubviews()})).then((function(){i.registerEventHandler(t.delegate("click",i.handleItemClick.bind(i),".context-item")),t.removeClass("loading"),setTimeout((function(){e.fire("droparound:reposition")}),0)}))},getSubviews:function(){var i=[],t=this;return this.params.isFollowing&&(i.push(this.appContext.getView("toggle-component-view",{type:"check",id:"coverphoto-context-mark-as-friend",labelText:this.intlMessage({intlName:"common.FRIEND"}),isBlock:!0,isChecked:this.params.relationshipModel.getValue("isFriend")}).then((function(e){return t.friendToggleView=e,e.initialize()}))),i.push(this.appContext.getView("toggle-component-view",{type:"check",id:"coverphoto-context-mark-as-family",labelText:this.intlMessage({intlName:"common.FAMILY"}),isBlock:!0,isChecked:this.params.relationshipModel.getValue("isFamily")}).then((function(e){return t.familyToggleView=e,e.initialize()})))),e.Promise.all(i)},insertSubviews:function(){var i=this,t=[];return this.friendToggleView&&(this.friendToggleNode.append(this.friendToggleView.get("container")),t.push(this.friendToggleView.activate())),this.familyToggleView&&(this.familyToggleNode.append(this.familyToggleView.get("container")),t.push(this.familyToggleView.activate())),e.Promise.all(t).then((function(){i.friendToggleView&&i.registerEventHandler(i.friendToggleView.on("toggled",i.handleFriendChange.bind(i))),i.familyToggleView&&i.registerEventHandler(i.familyToggleView.on("toggled",i.handleFamilyChange.bind(i)))}))},handleItemClick:function(e){var i=e.target.ancestor(".context-item",!0);this.fire("contextItemClicked",{itemId:i.getData("id")})},handleFriendChange:function(e){var i=this,r=this.params.relationshipModel,o=e.isChecked;return r.setValue("isFriend",o),r.remoteUpdate().catch((function(e){r.setValue("isFriend",!o),i.friendToggleView.toggleCheckedState(!o),t.error({err:e}),i.fire("friendChangeError")}))},handleFamilyChange:function(e){var i=this,r=this.params.relationshipModel,o=e.isChecked;return r.setValue("isFamily",o),r.remoteUpdate().catch((function(e){r.setValue("isFamily",!o),i.familyToggleView.toggleCheckedState(!o),t.error({err:e}),i.fire("familyChangeError")}))}})}),"@VERSION@",{requires:["flickr-view","hermes-template-coverphoto-context-menu","hermes-template-flickr-balls","url-helper"],optionalRequires:["hermes-core"],langBundles:["header","common","groups","photo-card","gallery","profile"]});YUI.add("hermes-template-gift-pro-checkout-page",(function(t,e){var n=t.Template.Handlebars.revive({1:function(t,e,n,l,a){var i,o=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,r="function",c=t.escapeExpression,m=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"\t\t\t\t\t\t\t<option value="+c(typeof(i=null!=(i=m(n,"product_id")||(null!=e?m(e,"product_id"):e))?i:s)===r?i.call(o,{name:"product_id",hash:{},data:a,loc:{start:{line:9,column:21},end:{line:9,column:35}}}):i)+">"+c(typeof(i=null!=(i=m(n,"amount")||(null!=e?m(e,"amount"):e))?i:s)===r?i.call(o,{name:"amount",hash:{},data:a,loc:{start:{line:9,column:36},end:{line:9,column:46}}}):i)+"</option>\n"},3:function(t,e,n,l,a){var i=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"\t\t\t\t\t\t"+t.escapeExpression((i(n,"intlMessage")||e&&i(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{name:null!=e?i(e,"prefillGiverName"):e,intlName:"gift-pro.SEND_FROM_WITHOUT_MESSAGE"},data:a,loc:{start:{line:15,column:6},end:{line:15,column:89}}}))+"\n"},5:function(t,e,n,l,a){var i=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"\t\t\t\t\t\t"+t.escapeExpression((i(n,"intlMessage")||e&&i(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{name:null!=e?i(e,"anonymous"):e,intlName:"gift-pro.SEND_FROM_WITHOUT_MESSAGE"},data:a,loc:{start:{line:17,column:6},end:{line:17,column:82}}}))+"\n"},7:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return t.escapeExpression("function"==typeof(i=null!=(i=o(n,"prefillGiverName")||(null!=e?o(e,"prefillGiverName"):e))?i:t.hooks.helperMissing)?i.call(null!=e?e:t.nullContext||{},{name:"prefillGiverName",hash:{},data:a,loc:{start:{line:25,column:158},end:{line:25,column:178}}}):i)},9:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return t.escapeExpression("function"==typeof(i=null!=(i=o(n,"prefillGiverEmail")||(null!=e?o(e,"prefillGiverEmail"):e))?i:t.hooks.helperMissing)?i.call(null!=e?e:t.nullContext||{},{name:"prefillGiverEmail",hash:{},data:a,loc:{start:{line:42,column:163},end:{line:42,column:184}}}):i)},compiler:[8,">= 4.3.0"],main:function(t,e,n,l,a){var i,o=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,r=t.escapeExpression,c=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="gift-checkout-container">\n\t<div class="step1 gift-plan-options">\n\t\t<div class="payment-method-view">\n\t\t\t<form id="gift-pro-form">\n\t\t\t\t<label for="amount">'+r((c(n,"intlMessage")||e&&c(e,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"gift-pro.CHOOSE_AMOUNT"},data:a,loc:{start:{line:5,column:24},end:{line:5,column:73}}}))+'</label>\n\t\t\t\t<div class="gift-pro-field">\n\t\t\t\t\t<select type="text" class="short" id="giftDuration">\n'+(null!=(i=c(n,"each").call(o,null!=e?c(e,"duration"):e,{name:"each",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a,loc:{start:{line:8,column:6},end:{line:10,column:15}}}))?i:"")+'\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t<p id="giver-info">\n'+(null!=(i=c(n,"if").call(o,null!=e?c(e,"prefillGiverName"):e,{name:"if",hash:{},fn:t.program(3,a,0),inverse:t.program(5,a,0),data:a,loc:{start:{line:14,column:5},end:{line:18,column:12}}}))?i:"")+'\t\t\t\t\t<a class="enable-change-giver-info">'+r((c(n,"intlMessage")||e&&c(e,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"gift-pro.CHANGE_GIVER_NAME"},data:a,loc:{start:{line:19,column:41},end:{line:19,column:94}}}))+'</a>\n\t\t\t\t</p>\n\t\t\t\t<a class="help-article" target="_blank" rel="noopener noreferrer" href="https://www.flickrhelp.com/hc/en-us/articles/4404079197076-Gifting-Pro">'+r((c(n,"intlMessage")||e&&c(e,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"gift-pro.HOW_DOES_GIFTING_WORK"},data:a,loc:{start:{line:21,column:148},end:{line:21,column:205}}}))+'</a>\n\t\t\t\t<div class="optional-gift-pro-fields" style="display: none;">\n\t\t\t\t\t<div class="gift-pro-field">\n\t\t\t\t\t\t<label for="name">'+r((c(n,"intlMessage")||e&&c(e,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"gift-pro.YOUR_NAME_OPTIONAL"},data:a,loc:{start:{line:24,column:24},end:{line:24,column:78}}}))+" — "+r((c(n,"intlMessage")||e&&c(e,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"gift-pro.YOUR_NAME_OPTIONAL_TIP"},data:a,loc:{start:{line:24,column:81},end:{line:24,column:139}}}))+'</label>\n\t\t\t\t\t\t<input type="text" id="giverName" name="name" placeholder="'+r((c(n,"intlMessage")||e&&c(e,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"gift-pro.ANONYMOUS"},data:a,loc:{start:{line:25,column:65},end:{line:25,column:110}}}))+'" maxlength="50" value="'+(null!=(i=c(n,"if").call(o,null!=e?c(e,"prefillGiverName"):e,{name:"if",hash:{},fn:t.program(7,a,0),inverse:t.noop,data:a,loc:{start:{line:25,column:134},end:{line:25,column:185}}}))?i:"")+'"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="gift-pro-field final">\n\t\t\t\t\t\t<label for="note">'+r((c(n,"intlMessage")||e&&c(e,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"gift-pro.YOUR_MESSAGE_OPTIONAL"},data:a,loc:{start:{line:28,column:24},end:{line:28,column:81}}}))+'</label>\n\t\t\t\t\t\t<input type="text" id="giftNote" name="note" placeholder="'+r((c(n,"intlMessage")||e&&c(e,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"gift-pro.GIFT_MESSAGE_NOTE_PLACEHOLDER"},data:a,loc:{start:{line:29,column:64},end:{line:29,column:129}}}))+'" maxlength="500"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="field-container button-container">\n\t\t\t\t\t<button class="btn btn-confirm continue-to-payment">'+r((c(n,"intlMessage")||e&&c(e,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"stats.NEXT"},data:a,loc:{start:{line:33,column:57},end:{line:33,column:94}}}))+'</button>\n\t\t\t\t</div>\n\t\t\t</form>\t\n\t\t</div>\n\t</div>\n\t<div class="step2 gift-payment-method" style="display: none;">\n\t\t<div class="gift-plan-options">\n\t\t\t<p class="giver-email with-payment-element">\n\t\t\t\t<label for="email">'+r((c(n,"intlMessage")||e&&c(e,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"gift-pro.YOUR_EMAIL_ADDRESS"},data:a,loc:{start:{line:41,column:23},end:{line:41,column:77}}}))+" — "+r((c(n,"intlMessage")||e&&c(e,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"gift-pro.WE_SEND_RECEIPT"},data:a,loc:{start:{line:41,column:80},end:{line:41,column:131}}}))+'</label>\n\t\t\t\t<input type="email" required id="giverEmail" name="email" placeholder="'+r((c(n,"intlMessage")||e&&c(e,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"gift-pro.PLEASE_ENTER_EMAIL"},data:a,loc:{start:{line:42,column:75},end:{line:42,column:129}}}))+'" value="'+(null!=(i=c(n,"if").call(o,null!=e?c(e,"prefillGiverEmail"):e,{name:"if",hash:{},fn:t.program(9,a,0),inverse:t.noop,data:a,loc:{start:{line:42,column:138},end:{line:42,column:191}}}))?i:"")+'"/>\n\t\t\t\t<span class="error">'+r((c(n,"intlMessage")||e&&c(e,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"gift-pro.A_VALID_EMAIL_REQUIRED"},data:a,loc:{start:{line:43,column:24},end:{line:43,column:82}}}))+"</span>\n\t\t\t</p>\n\t\t</div>\n\t\t"+r((c(n,"outlet")||e&&c(e,"outlet")||s).call(o,null!=e?c(e,"payment-method-view"):e,{name:"outlet",hash:{},data:a,loc:{start:{line:46,column:2},end:{line:46,column:32}}}))+"\n\t</div>\n</div>\n\n"},useData:!0}),l={};t.Array.each([],(function(e){var n=t.Template.get("hermes/"+e);n&&(l[e]=n)})),t.Template.register("hermes/gift-pro-checkout-page",(function(e,a){return(a=a||{}).partials=a.partials?t.merge(l,a.partials):l,n(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-checkout-legal-renewal-text",(function(e,l){var t=e.Template.Handlebars.revive({1:function(e,l,t,n,r){var a=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'\t<p class="legal-text">'+e.escapeExpression((a(t,"intlHTMLMessage")||l&&a(l,"intlHTMLMessage")||e.hooks.helperMissing).call(null!=l?l:e.nullContext||{},{name:"intlHTMLMessage",hash:{urlTerms:"/help/terms",urlPolicy:"/help/privacy",intlName:"checkout.LEGAL_TERMS_GIFT"},data:r,loc:{start:{line:2,column:23},end:{line:2,column:128}}}))+"</p>\n"},3:function(e,l,t,n,r){var a=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'\t<p class="legal-text">'+e.escapeExpression((a(t,"intlHTMLMessage")||l&&a(l,"intlHTMLMessage")||e.hooks.helperMissing).call(null!=l?l:e.nullContext||{},{name:"intlHTMLMessage",hash:{urlTerms:"/help/terms",urlPolicy:"/help/privacy",intlName:"checkout.AGREE_TO_TERMS"},data:r,loc:{start:{line:4,column:23},end:{line:4,column:126}}}))+"</p>\n"},compiler:[8,">= 4.3.0"],main:function(e,l,t,n,r){var a,s=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return null!=(a=s(t,"if").call(null!=l?l:e.nullContext||{},null!=l?s(l,"isGift"):l,{name:"if",hash:{},fn:e.program(1,r,0),inverse:e.program(3,r,0),data:r,loc:{start:{line:1,column:0},end:{line:5,column:7}}}))?a:""},useData:!0}),n={};e.Array.each([],(function(l){var t=e.Template.get("hermes/"+l);t&&(n[l]=t)})),e.Template.register("hermes/checkout-legal-renewal-text",(function(l,r){return(r=r||{}).partials=r.partials?e.merge(n,r.partials):n,t(l,r)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-payment-method",(function(t,e){var n=t.Template.Handlebars.revive({1:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t<div class="is-loading">\n'+(null!=(i=t.invokePartial(o(l,"flickr-balls"),e,{name:"flickr-balls",data:a,indent:"\t\t",helpers:n,partials:l,decorators:t.decorators}))?i:"")+"\t</div>\n"},3:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t<div class="billing-details">\n'+(null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"extendedBillingForm"):e,{name:"if",hash:{},fn:t.program(4,a,0),inverse:t.program(42,a,0),data:a,loc:{start:{line:7,column:3},end:{line:157,column:10}}}))?i:"")+"\t\t</div>\n\t\t\n\t</form>\n\n"},4:function(t,e,n,l,a){var i,o,r=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,c=t.escapeExpression,u=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t<div id="divider">\n\t\t\t\t\t<span class="or-checkout-divider">'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.OR_PAY_WITH_CARD"},data:a,loc:{start:{line:9,column:39},end:{line:9,column:91}}}))+'</span>\n\t\t\t\t</div>\n\t\t\t\t<form id="billing-form" action="/account/upgrade/pro" method="post" autocomplete="on">\n\t\t\t\t\t<div class="billing-container address-container">\n\t\t\t\t\t\t<h4>'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.BILLING_ADDRESS"},data:a,loc:{start:{line:13,column:10},end:{line:13,column:61}}}))+'</h4>\n\n\t\t\t\t\t\t<div class="field-container">\n\t\t\t\t\t\t\t<div class="name-block">\n\t\t\t\t\t\t\t\t<label for="name" class="title">'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.BILLING_ADDRESS_NAME"},data:a,loc:{start:{line:17,column:40},end:{line:17,column:96}}}))+'</label>\n\t\t\t\t\t\t\t\t<div class="field-wrapper">\n\t\t\t\t\t\t\t\t\t<input id="name" name="billing-name" autocomplete="billing name" type="text" pattern="([\\u4e00-\\u9fa5_A-z0-9À-ž-\'.\\s]){2,}" class="long" required maxlength="100" placeholder=" " '+(null!=(i=u(n,"if").call(r,null!=e?u(e,"vendorUser"):e,{name:"if",hash:{},fn:t.program(5,a,0),inverse:t.noop,data:a,loc:{start:{line:19,column:187},end:{line:19,column:241}}}))?i:"")+'>\n\n\t\t\t\t\t\t\t\t\t<div class="cc-name-is-invalid-message hidden error-message">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class="street-block">\n\t\t\t\t\t\t\t\t<label for="billing-street-address" class="title">'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.INPUT_STREET"},data:a,loc:{start:{line:27,column:58},end:{line:27,column:106}}}))+'</label>\n\t\t\t\t\t\t\t\t<div class="field-wrapper">\n\t\t\t\t\t\t\t\t\t<input id="line1" name="billing-street-address" autocomplete="billing address-line1" type="text" pattern="([\\u4e00-\\u9fa5_A-z0-9À-ž-,.#`\'/\\s]){3,}" class="long"  maxlength="100" placeholder=" " required '+(null!=(i=u(n,"if").call(r,null!=e?u(e,"vendorUser"):e,{name:"if",hash:{},fn:t.program(7,a,0),inverse:t.noop,data:a,loc:{start:{line:29,column:212},end:{line:29,column:275}}}))?i:"")+'>\n\n\t\t\t\t\t\t\t\t\t<div class="cc-street-is-invalid-message hidden error-message">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class="add-line-2-container">\n\t\t\t\t\t\t\t\t<a class="add-line-2" '+(null!=(i=u(n,"if").call(r,null!=e?u(e,"canShowLine2Link"):e,{name:"if",hash:{},fn:t.noop,inverse:t.program(9,a,0),data:a,loc:{start:{line:37,column:30},end:{line:37,column:83}}}))?i:"")+">"+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.ADD_LINE_2"},data:a,loc:{start:{line:37,column:84},end:{line:37,column:130}}}))+'</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="street2-block" '+(null!=(i=u(n,"if").call(r,null!=e?u(e,"hasLine2"):e,{name:"if",hash:{},fn:t.noop,inverse:t.program(9,a,0),data:a,loc:{start:{line:39,column:34},end:{line:39,column:79}}}))?i:"")+'>\n\t\t\t\t\t\t\t\t<div class="field-wrapper">\n\t\t\t\t\t\t\t\t\t<input id="line2" name="billing-street-address" autocomplete="billing address-line2" type="text" pattern="([\\u4e00-\\u9fa5_A-z0-9À-ž-,.#`\'/\\s]){3,}" class="long"  maxlength="100" placeholder="'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.LINE_2_OPTIONAL"},data:a,loc:{start:{line:41,column:200},end:{line:41,column:251}}}))+'" '+(null!=(i=u(n,"if").call(r,null!=e?u(e,"vendorUser"):e,{name:"if",hash:{},fn:t.program(11,a,0),inverse:t.noop,data:a,loc:{start:{line:41,column:253},end:{line:41,column:316}}}))?i:"")+'>\n\n\t\t\t\t\t\t\t\t\t<div class="cc-street2-is-invalid-message hidden error-message">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class="city-block">\n\t\t\t\t\t\t\t\t<label for="billing-city" class="title">'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.INPUT_CITY"},data:a,loc:{start:{line:49,column:48},end:{line:49,column:94}}}))+'</label>\n\t\t\t\t\t\t\t\t<div class="field-wrapper">\n\t\t\t\t\t\t\t\t\t<input id="city" name="billing-city" autocomplete="billing address-level2" type="text" pattern="([\\u4e00-\\u9fa5_A-z0-9À-ž-,.`\'\\s]){3,}" class="long" maxlength="35" required placeholder=" "  '+(null!=(i=u(n,"if").call(r,null!=e?u(e,"vendorUser"):e,{name:"if",hash:{},fn:t.program(13,a,0),inverse:t.noop,data:a,loc:{start:{line:51,column:199},end:{line:51,column:261}}}))?i:"")+'>\n\t\t\t\t\t\t\t\t\t<div class="cc-city-is-invalid-message hidden error-message">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div class="zip-city-state">\n\n\t\t\t\t\t\t\t\t<div class="country-block">\n\t\t\t\t\t\t\t\t\t<label for="billing-country" class="title">'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.INPUT_COUNTRY"},data:a,loc:{start:{line:60,column:52},end:{line:60,column:101}}}))+'</label>\n\t\t\t\t\t\t\t\t\t<div class="field-wrapper">\n\t\t\t\t\t\t\t\t\t\t<select id="country-code" name="billing-country" autocomplete="billing country-name" type="text" class="short" required>\n'+(null!=(i=u(n,"each").call(r,null!=e?u(e,"countries"):e,{name:"each",hash:{},fn:t.program(15,a,0),inverse:t.noop,data:a,loc:{start:{line:63,column:11},end:{line:65,column:20}}}))?i:"")+'\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t<div class="cc-country-is-invalid-message hidden error-message">\n\t\t\t\t\t\t\t\t\t\t\t'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.PLEASE_SELECT_A_COUNTRY"},data:a,loc:{start:{line:68,column:11},end:{line:68,column:70}}}))+'\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class="state-block '+(null!=(i=u(n,"if").call(r,null!=e?u(e,"isINTLSelected"):e,{name:"if",hash:{},fn:t.program(19,a,0),inverse:t.noop,data:a,loc:{start:{line:73,column:32},end:{line:73,column:65}}}))?i:"")+'">\n\t\t\t\t\t\t\t\t\t<label for="billing-state" class="title billing-state-legend">'+(null!=(i=u(n,"if").call(r,null!=e?u(e,"isUSSelected"):e,{name:"if",hash:{},fn:t.program(21,a,0),inverse:t.program(23,a,0),data:a,loc:{start:{line:74,column:71},end:{line:74,column:230}}}))?i:"")+'</label>\n\t\t\t\t\t\t\t\t\t<div class="field-wrapper us">\n\t\t\t\t\t\t\t\t\t\t<select id="state-us"  name="billing-state" autocomplete="billing address-level1" type="text" class="short '+(null!=(i=u(n,"if").call(r,null!=e?u(e,"isCASelected"):e,{name:"if",hash:{},fn:t.program(19,a,0),inverse:t.noop,data:a,loc:{start:{line:76,column:117},end:{line:76,column:148}}}))?i:"")+'" required>\n'+(null!=(i=u(n,"each").call(r,null!=e?u(e,"usStates"):e,{name:"each",hash:{},fn:t.program(26,a,0),inverse:t.noop,data:a,loc:{start:{line:77,column:11},end:{line:79,column:20}}}))?i:"")+'\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t<select id="state-ca"  name="billing-state" autocomplete="billing address-level1" type="text" class="short '+(null!=(i=u(n,"if").call(r,null!=e?u(e,"isUSSelected"):e,{name:"if",hash:{},fn:t.program(19,a,0),inverse:t.noop,data:a,loc:{start:{line:81,column:117},end:{line:81,column:148}}}))?i:"")+'" required>\n'+(null!=(i=u(n,"each").call(r,null!=e?u(e,"canadaProvinces"):e,{name:"each",hash:{},fn:t.program(26,a,0),inverse:t.noop,data:a,loc:{start:{line:82,column:11},end:{line:84,column:20}}}))?i:"")+'\t\t\t\t\t\t\t\t\t\t</select>\n\n\t\t\t\t\t\t\t\t\t\t<div class="cc-state-is-invalid-message hidden error-message">\n\t\t\t\t\t\t\t\t\t\t\t'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.PLEASE_SELECT_A_STATE"},data:a,loc:{start:{line:88,column:11},end:{line:88,column:68}}}))+'\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class="zipcode-block">\n\t\t\t\t\t\t\t\t\t<label for="billing-postal-code" class="title billing-postal-code">'+(null!=(i=u(n,"if").call(r,null!=e?u(e,"isUSSelected"):e,{name:"if",hash:{},fn:t.program(30,a,0),inverse:t.program(32,a,0),data:a,loc:{start:{line:94,column:76},end:{line:94,column:214}}}))?i:"")+'</label>\n\t\t\t\t\t\t\t\t\t<div class="field-wrapper">\n\t\t\t\t\t\t\t\t\t\t<input id="zip-code" name="billing-postal-code" autocomplete="billing postal-code" type="text" class="short" required placeholder=" " maxlength="10" value="'+(null!=(i=u(n,"if").call(r,null!=e?u(e,"vendorUser"):e,{name:"if",hash:{},fn:t.program(34,a,0),inverse:t.noop,data:a,loc:{start:{line:96,column:166},end:{line:96,column:225}}}))?i:"")+'">\n\t\t\t\t\t\t\t\t\t\t<div class="cc-country-is-invalid-message hidden error-message">\n\t\t\t\t\t\t\t\t\t\t\t'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.PLEASE_SELECT_A_COUNTRY"},data:a,loc:{start:{line:98,column:11},end:{line:98,column:70}}}))+'\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="credit-card-details">\n\t\t\t\t\t\t<h4>'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.PAYMENT_METHOD_TITLE"},data:a,loc:{start:{line:107,column:10},end:{line:107,column:66}}}))+" "+(null!=(i=(u(n,"isFlipped")||e&&u(e,"isFlipped")||s).call(r,"enable-stripe-test",{name:"isFlipped",hash:{},fn:t.program(36,a,0),inverse:t.noop,data:a,loc:{start:{line:107,column:67},end:{line:107,column:157}}}))?i:"")+'</h4>\n\t\t\t\n\t\t\t\t\t\t<div class="card-container">\n\t\t\t\t\t\t\t<div class="credit-card-number">\n\t\t\t\t\t\t\t\t<label for="credit-card-number" class="title">'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.INPUT_CREDIT_CARD_NUMBER"},data:a,loc:{start:{line:111,column:54},end:{line:111,column:114}}}))+'</label>\n\t\t\t\t\t\t\t\t<div class="field-wrapper">\n\t\t\t\t\t\t\t\t\t<div id="credit-card-number"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="credit-card-expiry">\n\t\t\t\t\t\t\t\t<label for="credit-card-expiry" class="title">'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.INPUT_EXPIRATION_DATE"},data:a,loc:{start:{line:117,column:54},end:{line:117,column:111}}}))+'</label>\n\t\t\t\t\t\t\t\t<div class="field-wrapper">\n\t\t\t\t\t\t\t\t\t<div id="credit-card-expiry"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="credit-card-cvv">\n\t\t\t\t\t\t\t\t<label for="credit-card-cvv" class="title">'+c((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"checkout.INPUT_SECURITY_CODE"},data:a,loc:{start:{line:123,column:51},end:{line:123,column:106}}}))+'</label>\n\t\t\t\t\t\t\t\t<div class="field-wrapper">\n\t\t\t\t\t\t\t\t\t<div id="credit-card-cvv"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p id="card-errors" class="field-has-error"></p>\n\t\t\t\t\t</div>\n'+(null!=(i=u(n,"if").call(r,null!=e?u(e,"isUpdatePaymentMethodView"):e,{name:"if",hash:{},fn:t.program(38,a,0),inverse:t.program(40,a,0),data:a,loc:{start:{line:131,column:5},end:{line:136,column:12}}}))?i:"")+'\t\t\t\t\t<div class="field-container button-container">\n'+(null!=(i=t.invokePartial(u(l,"flickr-balls"),e,{name:"flickr-balls",data:a,indent:"\t\t\t\t\t\t",helpers:n,partials:l,decorators:t.decorators}))?i:"")+'\n\t\t\t\t\t\t<button id="submit" type="submit" class="btn large" disabled>'+c("function"==typeof(o=null!=(o=u(n,"buttonTextComplete")||(null!=e?u(e,"buttonTextComplete"):e))?o:s)?o.call(r,{name:"buttonTextComplete",hash:{},data:a,loc:{start:{line:140,column:67},end:{line:140,column:89}}}):o)+"</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n"},5:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return' value="'+t.escapeExpression(t.lambda(null!=(i=null!=e?o(e,"vendorUser"):e)?o(i,"name"):i,e))+'" '},7:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return' value="'+t.escapeExpression(t.lambda(null!=(i=null!=(i=null!=e?o(e,"vendorUser"):e)?o(i,"address"):i)?o(i,"line1"):i,e))+'" '},9:function(t,e,n,l,a){return'style="display: none;"'},11:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return' value="'+t.escapeExpression(t.lambda(null!=(i=null!=(i=null!=e?o(e,"vendorUser"):e)?o(i,"address"):i)?o(i,"line2"):i,e))+'" '},13:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return' value="'+t.escapeExpression(t.lambda(null!=(i=null!=(i=null!=e?o(e,"vendorUser"):e)?o(i,"address"):i)?o(i,"city"):i,e))+'" '},15:function(t,e,n,l,a){var i,o,r=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,c="function",u=t.escapeExpression,d=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t\t\t\t\t\t\t\t\t<option value="'+u(typeof(o=null!=(o=d(n,"countryCode")||(null!=e?d(e,"countryCode"):e))?o:s)===c?o.call(r,{name:"countryCode",hash:{},data:a,loc:{start:{line:64,column:27},end:{line:64,column:42}}}):o)+'" '+(null!=(i=d(n,"if").call(r,(i=a&&d(a,"root"))&&d(i,"vendorUser"),{name:"if",hash:{},fn:t.program(16,a,0),inverse:t.noop,data:a,loc:{start:{line:64,column:44},end:{line:64,column:156}}}))?i:"")+">"+u(typeof(o=null!=(o=d(n,"countryName")||(null!=e?d(e,"countryName"):e))?o:s)===c?o.call(r,{name:"countryName",hash:{},data:a,loc:{start:{line:64,column:157},end:{line:64,column:172}}}):o)+"</option>\n"},16:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=(o(n,"ifCond")||e&&o(e,"ifCond")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},(i=(i=(i=a&&o(a,"root"))&&o(i,"vendorUser"))&&o(i,"address"))&&o(i,"country"),"===",null!=e?o(e,"countryCode"):e,{name:"ifCond",hash:{},fn:t.program(17,a,0),inverse:t.noop,data:a,loc:{start:{line:64,column:68},end:{line:64,column:149}}}))?i:""},17:function(t,e,n,l,a){return"selected"},19:function(t,e,n,l,a){return"hide"},21:function(t,e,n,l,a){var i=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return t.escapeExpression((i(n,"intlMessage")||e&&i(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"checkout.INPUT_STATE"},data:a,loc:{start:{line:74,column:91},end:{line:74,column:138}}}))},23:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"isCASelected"):e,{name:"if",hash:{},fn:t.program(24,a,0),inverse:t.noop,data:a,loc:{start:{line:74,column:146},end:{line:74,column:223}}}))?i:""},24:function(t,e,n,l,a){var i=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return t.escapeExpression((i(n,"intlMessage")||e&&i(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"checkout.INPUT_PROVINCE"},data:a,loc:{start:{line:74,column:166},end:{line:74,column:216}}}))},26:function(t,e,n,l,a){var i,o=t.lambda,r=t.escapeExpression,s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t\t\t\t\t\t\t\t\t<option value="'+r(o(e,e))+'" '+(null!=(i=s(n,"if").call(null!=e?e:t.nullContext||{},(i=a&&s(a,"root"))&&s(i,"vendorUser"),{name:"if",hash:{},fn:t.program(27,a,0),inverse:t.noop,data:a,loc:{start:{line:78,column:37},end:{line:78,column:153}}}))?i:"")+">"+r(o(e,e))+"</option>\n"},27:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=(o(n,"ifCond")||e&&o(e,"ifCond")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},(i=(i=(i=a&&o(a,"root"))&&o(i,"vendorUser"))&&o(i,"address"))&&o(i,"state"),"===",e,{name:"ifCond",hash:{},fn:t.program(28,a,0),inverse:t.noop,data:a,loc:{start:{line:78,column:61},end:{line:78,column:146}}}))?i:""},28:function(t,e,n,l,a){return'  selected="selected"'},30:function(t,e,n,l,a){var i=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return t.escapeExpression((i(n,"intlMessage")||e&&i(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"checkout.INPUT_ZIP_CODE"},data:a,loc:{start:{line:94,column:96},end:{line:94,column:146}}}))},32:function(t,e,n,l,a){var i=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return t.escapeExpression((i(n,"intlMessage")||e&&i(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"checkout.INPUT_POSTAL_CODE"},data:a,loc:{start:{line:94,column:154},end:{line:94,column:207}}}))},34:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return t.escapeExpression(t.lambda(null!=(i=null!=(i=null!=e?o(e,"vendorUser"):e)?o(i,"address"):i)?o(i,"postal_code"):i,e))},36:function(t,e,n,l,a){return'<span class="label-beta">TEST MODE</span>'},38:function(t,e,n,l,a){return'\t\t\t\t\t\t\t<p class="legal-text"></p>\n'},40:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=t.invokePartial(o(l,"checkout-legal-renewal-text"),e,{name:"checkout-legal-renewal-text",hash:{isGift:null!=e?o(e,"isGift"):e},data:a,indent:"\t\t\t\t\t\t",helpers:n,partials:l,decorators:t.decorators}))?i:""},42:function(t,e,n,l,a){var i,o,r=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,c=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t<form id="payment-method-form" action="/account/upgrade/pro" method="post" autocomplete="on">\n\t\t\t\t\t'+(null!=(i=(c(n,"isFlipped")||e&&c(e,"isFlipped")||s).call(r,"enable-stripe-test",{name:"isFlipped",hash:{},fn:t.program(36,a,0),inverse:t.noop,data:a,loc:{start:{line:145,column:5},end:{line:145,column:95}}}))?i:"")+"\n"+(null!=(i=t.invokePartial(c(l,"flickr-balls"),e,{name:"flickr-balls",data:a,indent:"\t\t\t\t\t",helpers:n,partials:l,decorators:t.decorators}))?i:"")+'\t\t\t\t\t<div id="payment-element"></div>\n\n\t\t\t\t\t\t\n'+(null!=(i=t.invokePartial(c(l,"checkout-legal-renewal-text"),e,{name:"checkout-legal-renewal-text",hash:{isSingleTransaction:null!=e?c(e,"isGift"):e,yearly:null!=e?c(e,"hasYearlyLegalNotice"):e},data:a,indent:"\t\t\t\t\t",helpers:n,partials:l,decorators:t.decorators}))?i:"")+'\t\t\t\t\t<div class="field-container button-container">\n'+(null!=(i=t.invokePartial(c(l,"flickr-balls"),e,{name:"flickr-balls",data:a,indent:"\t\t\t\t\t\t",helpers:n,partials:l,decorators:t.decorators}))?i:"")+'\t\t\t\t\t\t<button id="submit" type="submit" class="btn" disabled>'+t.escapeExpression("function"==typeof(o=null!=(o=c(n,"buttonTextComplete")||(null!=e?c(e,"buttonTextComplete"):e))?o:s)?o.call(r,{name:"buttonTextComplete",hash:{},data:a,loc:{start:{line:153,column:61},end:{line:153,column:83}}}):o)+"</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\n"},compiler:[8,">= 4.3.0"],main:function(t,e,n,l,a){var i,o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"isLoading"):e,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.program(3,a,0),data:a,loc:{start:{line:1,column:0},end:{line:162,column:7}}}))?i:""},usePartial:!0,useData:!0}),l={};t.Array.each(["flickr-balls","checkout-legal-renewal-text","flickr-balls","flickr-balls","checkout-legal-renewal-text","flickr-balls"],(function(e){var n=t.Template.get("hermes/"+e);n&&(l[e]=n)})),t.Template.register("hermes/payment-method",(function(e,a){return(a=a||{}).partials=a.partials?t.merge(l,a.partials):l,n(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-flickr-balls","hermes-template-checkout-legal-renewal-text","hermes-template-flickr-balls","hermes-template-flickr-balls","hermes-template-checkout-legal-renewal-text","hermes-template-flickr-balls"]});YUI.add("payment-method-view",(function(e,t){"use strict";var i,n=require("hermes-core/flog")(t),s=new e.SubscriptionsHelper;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.shouldDisplayYearlyLegalNotice=t.shouldDisplayYearlyLegalNotice,this.extendedBillingForm=t.extendedBillingForm,this.hideCompleteButton=t.hideCompleteButton||!1,this.validateOnBlur=t.validateOnBlur||!1,this.isGift=t.isGift,this.isUpdatePaymentMethodView=t.isUpdatePaymentMethodView||!1,this.isMobile=t.isMobile,this.planId=t.planId,this.nsid=t.nsid,this.setContainerWithTemplate("payment-method",{isLoading:!0}),i=this.appContext.flipper.isFlipped("enable-stripe-test")?e.config.flickr.stripe.testPublishableK:e.config.flickr.stripe.livePublishableK,this.fieldsStyle={base:{color:"#212124",fontFamily:'"Proxima Nova", "helvetica neue", helvetica, arial, sans-serif',fontSize:"14px","::placeholder":{color:"#b3b3b3"},":-webkit-autofill":{color:"#212124",backgroundColor:"#f3f5f6"}},invalid:{color:"#E2292B",iconColor:"#fa755a"}},this.buttonTextComplete=t.buttonTextComplete||this.intlMessage({intlName:"checkout.COMPLETE_PURCHASE"}),this},loadState:function(){var t=require("@stripe/stripe-js").loadStripe(i,{locale:s.getStripeLocale(this.appContext.lang)}).then(function(e){this.stripe=e}.bind(this));return this.appContext.getViewer().signedIn?e.Promise.all([t,this.appContext.callAPI("flickr.subscriptions.vendor.getUser",{vendor:"stripe",cacheBuster:(new Date).getTime()})]).then(function(e){var t=e[1];t&&"ok"===t.stat&&t.user&&t.user.address?this.set("vendorUser",t.user):this.set("vendorUser",!1)}.bind(this)).catch(function(e){n.log(e),this.set("vendorUser",!1)}.bind(this)):e.Promise.resolve()},buildContainer:function(){var e=!0,t=!1,i=!1,n=!1;if(this.get("vendorUser")&&this.get("vendorUser").address){var a=this.get("vendorUser").address;a.country&&("US"===a.country?(e=!0,t=!1,i=!1):"CA"===a.country?(e=!1,t=!0,i=!1):(e=!1,t=!1,i=!0)),a.line2&&(n=!0)}var r={isLoading:!1,extendedBillingForm:this.extendedBillingForm,isGift:this.isGift,isUpdatePaymentMethodView:this.isUpdatePaymentMethodView,hasYearlyLegalNotice:void 0!==this.shouldDisplayYearlyLegalNotice?this.shouldDisplayYearlyLegalNotice:s.hasYearlyLegalNotice(this.planId),current_year:(new Date).getFullYear(),countries:s.countriesArray,usStates:s.usStatesArray,canadaProvinces:s.canadaProvincesArray,buttonTextComplete:this.buttonTextComplete,vendorUser:this.get("vendorUser"),isUSSelected:e,isCASelected:t,isINTLSelected:i,hasLine2:n,canShowLine2Link:!n&&!i};return this.setContainerWithTemplate("payment-method",r),this},activate:function(){var t=this.get("container");if(this.registerEventHandler(e.on("paymentMethodsModal:reEnableUI",this.reEnablePaymentUI.bind(this))),this.registerEventHandler(e.on("paymentMethodsModalGift:paymentSecretReceived",this.onPaymentIntentReceived.bind(this))),this.registerEventHandler(e.on("digitalWallets:toggleBillingForm",this.toggleBillingForm.bind(this))),this.extendedBillingForm&&this.createStripeHostedFields(),this.extendedBillingForm){if(this.registerEventHandler(t.one("#billing-form").on("submit",this.createPaymentMethod.bind(this))),this.registerEventHandler(t.one("#country-code").on("change",this.onCountryChange.bind(this))),this.validateOnBlur){var i=t.all(".billing-container input, .billing-container select");this.registerEventHandler(i.on("focus",this.clearTimeout.bind(this))),this.registerEventHandler(i.on("blur",this.startTimerForAddressValidation.bind(this))),this.registerEventHandler(i.on("valuechange",this.resetFieldValidity))}var n=this.get("container").one(".add-line-2");n&&this.registerEventHandler(n.on("click",function(e){e.preventDefault(),this.get("container").one(".add-line-2").hide(),this.get("container").one(".street2-block").show()}.bind(this)))}else this.registerEventHandler(t.one("#payment-method-form").on("submit",this.onPaymentFormSubmit.bind(this)));return this},toggleBillingForm:function(){var e=this.get("container"),t=e.one("#billing-form"),i=e.one("#divider");t.toggleClass("close"),i.toggleClass("close")},resetFieldValidity:function(e){e&&e.target&&(e.target.getDOMNode().setCustomValidity(""),e.target.getDOMNode().reportValidity())},startTimerForAddressValidation:function(){this.clearTimeout(),this.validateAddressTimeout=setTimeout(this.validateBillingAddress.bind(this),600)},clearTimeout:function(e){this.validateAddressTimeout&&clearTimeout(this.validateAddressTimeout)},createStripeHostedFields:function(){var e=this.stripe.elements({locale:s.getStripeLocale(this.appContext.lang)});if(this.extendedBillingForm){var t=e.create("cardNumber",{style:this.fieldsStyle}),i=e.create("cardExpiry",{style:this.fieldsStyle}),n=e.create("cardCvc",{style:this.fieldsStyle});t.mount("#credit-card-number"),i.mount("#credit-card-expiry"),n.mount("#credit-card-cvv"),this.set("card",t),t.on("change",this.handleRealTimeCardChange.bind(this)),i.on("change",this.handleRealTimeCardChange.bind(this)),n.on("change",this.handleRealTimeCardChange.bind(this))}else{var a=e.create("card",{style:this.fieldsStyle});a.mount("#credit-card"),a.on("change",this.handleRealTimeCardChange.bind(this)),this.set("card",a)}},handleRealTimeCardChange:function(e){var t=document.querySelector("#card-errors");t&&(document.querySelector("#submit").disabled=e.empty,e.error?(t.textContent=e.error.message,this.disableSubmitBtn()):(t.textContent="",this.reEnableSubmitBtn()))},displayCardError:function(e){document.querySelector("#card-errors").textContent=e},createPaymentMethod:function(e){var t=this.getBillingAddress();return e&&(e.preventDefault(),e.stopPropagation()),this.disablePaymentUI(!0),this.stripe.createPaymentMethod({type:"card",card:this.get("card"),billing_details:{name:t.name,address:{line1:t.address_line1,line2:t.address_line2||"",city:t.address_city,state:t.address_state,country:t.address_country,postal_code:t.address_postal_code}}}).then(function(e){e.error?(this.displayCardError(e.error.message),this.reEnablePaymentUI()):(this.disableSubmitBtn(),n.log("payment method successfully created"),this.fire("paymentMethodCreated",{paymentMethod:e.paymentMethod}))}.bind(this))},onPaymentFormSubmit:function(e){e.preventDefault(),n.log("asking for payment request"),this.extendedBillingForm||this.fire("paymentMethodsModalGift:confirmPaymentIntent",{elements:this.elements})},validateBillingAddress:function(e){e&&e.preventDefault();var t=this.get("container").one("#billing-form").getDOMNode();if(!this.isValidating&&t&&t.checkValidity()){this.isValidating=!0,n.log("Form is valid, saving");var i={billingData:this.getBillingAddress()};return this.fire("billingAddressedComplete",i),this.isValidating=!1,i}return this.isValidating=!1,n.log("Form is invalid, skip"),!1},createPaymentElement:function(e){this.elements=this.stripe.elements({locale:s.getStripeLocale(this.appContext.lang),clientSecret:e.paymentSecret,appearance:{theme:"none",variables:{colorIconTabHover:"var(--colorText)",colorTextPlaceholder:"#b3b3b3",colorPrimary:"#0091dc",colorPrimaryActive:"#0091dc",colorPrimaryHover:"#0091dc"},rules:{".Tab":{border:"1px solid #9ea4a7",boxShadow:"0px 1px 1px rgba(0, 0, 0, 0.03), 0px 3px 6px rgba(18, 42, 66, 0.02)"},".Tab:hover":{color:"var(--colorText)"},".Tab--selected":{border:"1px solid #9ea4a7",borderBottom:"4px solid #0091dc",outline:"none"},".TabIcon--selected":{fill:"#0091dc"},".TabIcon:hover":{fill:"var(--colorText)"},".TabLabel--selected":{color:"#0091dc"},".Input--invalid":{border:"none",boxShadow:"0 1px 1px 0 rgba(0, 0, 0, 0.07), 0 0 0 2px var(--colorDanger)"},".Input":{border:"1px solid #9ea4a7",fontSize:"14px"},".Input:focus":{border:"1px solid #0091dc"},".Input:focus-visible":{outline:"none"},".Label":{color:"#999",fontSize:"14px"},".Input::placeholder":{fontSize:"14px"}}}});var t=this.elements.create("payment",{business:{name:"Flickr"},fields:{billingDetails:"auto"}});t.mount("#payment-element"),this.registerEventHandler(t.on("change",function(e){e.complete?this.reEnablePaymentUI():this.disableSubmitBtn()}.bind(this))),this.get("container").one(".balls").setAttribute("style","display: none;")},confirmPaymentIntent:function(){return this.disablePaymentUI(!0),this.stripe.confirmPayment({elements:this.elements,confirmParams:{return_url:"https://flickr.com"},redirect:"if_required"}).then(function(e){return e.error?(this.somethingWentWrong(e.error.message),this.reEnablePaymentUI(),e.error.message):e.paymentIntent}.bind(this)).catch(function(e){n.log("error confirming stripe payment",e),this.somethingWentWrong(e&&e.message?e.message:e),this.reEnablePaymentUI()}.bind(this))},onPaymentIntentReceived:function(t){this.disablePaymentUI(!0),this.stripe.confirmPayment({elements:this.elements,confirmParams:{return_url:"https://flickr.com"},redirect:"if_required"}).then(function(t){t.error?(this.somethingWentWrong(t.error.message),this.reEnablePaymentUI()):e.fire("giftProCheckoutView:handleGiftPayment",t.paymentIntent)}.bind(this)).catch(function(e){n.log("error confirming stripe payment",e),this.somethingWentWrong(e&&e.message?e.message:e),this.reEnablePaymentUI(),s.sendGiftPurchaseEvent({step:"gift_purchase_failed",error:e,recipientNsid:t.recipientNsid,gifterNsid:t.gifterNsid})}.bind(this))},orderComplete:function(){this.fire("paymentMethodsModalGift:paymentConfirmed")},getMonthsNameWithNumber:function(){var t=e.moment.months(),i=[];return t.forEach((function(e,t){e&&i.push(t+1+" - "+e)})),i},onCountryChange:function(e){var t=this.get("container"),i=this.getCountrySelected(),n=t.one(".state-block"),s=t.one(".billing-state-legend"),a=t.one(".billing-postal-code"),r=t.one(".street2-block"),o=t.one(".add-line-2"),l=t.one(".street2-block"),d=t.one("#line2");"US"===i||"CA"===i?("US"===i?(t.one("#state-us").removeClass("hide"),t.one("#state-ca").addClass("hide"),s.setContent(this.intlMessage({intlName:"checkout.INPUT_STATE"})),a.setContent(this.intlMessage({intlName:"checkout.INPUT_ZIP_CODE"}))):(t.one("#state-us").addClass("hide"),t.one("#state-ca").removeClass("hide"),s.setContent(this.intlMessage({intlName:"checkout.INPUT_PROVINCE"})),a.setContent(this.intlMessage({intlName:"checkout.INPUT_POSTAL_CODE"}))),n.removeClass("hide"),d.get("value")||(o.show(),l.hide()),this.isUpdatePaymentMethodView&&r.removeClass("hide")):(a.setContent(this.intlMessage({intlName:"checkout.INPUT_POSTAL_CODE"})),n.addClass("hide"),this.isUpdatePaymentMethodView&&r.addClass("hide"),o.hide(),d.set("value",""),l.hide()),this.disableSubmitBtn(),this.emptyZipCodeField()},emptyZipCodeField:function(){var e=this.get("container").one("#zip-code");e&&e.set("value",""),this.disableSubmitBtn(),e.set("value","")},getBillingAddress:function(){var e=this.get("container"),t=this.getCountrySelected(),i={address_line1:e.one("#line1").get("value"),address_line2:"",address_postal_code:e.one("#zip-code").get("value"),address_city:e.one("#city").get("value"),address_country:this.getCountrySelected(),name:e.one("#name").get("value")};return"US"===t?(i.address_state=e.one("#state-us").get("value"),i.address_line2=e.one("#line2").get("value")||""):"CA"===t?(i.address_state=e.one("#state-ca").get("value"),i.address_line2=e.one("#line2").get("value")||""):i.address_state="",i},updateBillingAddress:function(e){var t=this.get("container");e.addressLine1&&t.one("#line1").set("value",e.addressLine1),e.addressLine2?t.one("#line2").set("value",e.addressLine2):t.one("#line2").set("value",""),e.addressCity&&t.one("#city").set("value",e.addressCity),e.addressPostalCode&&t.one("#zip-code").set("value",e.addressPostalCode),e.addressState&&("US"===e.addressCountry?t.one("#state-us").set("value",e.addressState):"CA"===e.addressCountry&&t.one("#state-ca").set("value",e.addressState)),e.addressCountry&&t.one("#country-code").set("value",e.addressCountry),n.log("address updated with the validated address from the server")},getCountrySelected:function(){var e=this.get("container").one("#country-code");return e&&e.get("value")?e.get("value"):"US"},showCreditCardsFields:function(){var t=this.get("container");t.one(".billing-details").show(),t.one("#submit").show(),this.isMobile||e.fire("paymentMethodsModal:reposition")},reEnableSubmitBtn:function(){var e=this.get("container").one("#submit");e&&e.removeAttribute("disabled")},disableSubmitBtn:function(){var e=this.get("container").one("#submit");e&&e.setAttribute("disabled","disabled")},disablePaymentUI:function(e){var t=this.get("container"),i=t.one("#submit"),n=t.one(".button-container");t.one("#submit").setAttribute("disabled","disabled"),n.one(".balls").setAttribute("style","display: inline-block;"),t.addClass("wait"),e?i.set("text",this.buttonTextComplete):i.set("text",this.intlMessage({intlName:"common.SAVING"}))},reEnablePaymentUI:function(){var e=this.get("container"),t=e.one(".button-container"),i=e.one("#submit");e.one("#submit").removeAttribute("disabled"),t.one(".balls").removeAttribute("style"),e.removeClass("wait"),i.set("text",this.intlMessage({intlName:"checkout.COMPLETE_PURCHASE"}))},somethingWentWrong:function(t){var i=new e.Views.FluidModal({title:this.intlMessage({intlName:"common.OOPS"}),actionButtonLabel:this.intlMessage({intlName:"common.CLOSE"}),textMessage:t,appContext:this.appContext,dismissOnOverlayClick:!1,dismissOnActionClick:!0,actionButtonDisabled:!1,actionButtonIsDangerous:!0,showCancelButton:!1,showCancelX:!0});i.on("actionClick",function(){i.close()}.bind(this)),i.show(),s.log("Displayed somethingWentWrong modal")},destructor:function(){this.get("card")&&this.get("card").destroy()}})}),"@VERSION@",{requires:["flickr-view","subscriptions-helper","moment","hermes-template-flickr-balls","hermes-template-checkout-legal-renewal-text","hermes-template-payment-method"],optionalRequires:["stripe-js","hermes-core"],langBundles:["common","checkout","wallet","account-settings"]});