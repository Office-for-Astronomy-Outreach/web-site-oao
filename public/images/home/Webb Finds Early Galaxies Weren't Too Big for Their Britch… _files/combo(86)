YUI.add("photo-page-download-interstitial-view",(function(e,t){var i=require("hermes-core/flog")(t),r=new e.SubscriptionsHelper;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.params=t,this.adTimerStartValue=e.config.flickr.moola.positions.interstitials[2].ad_timer_start_value,this.interstitialType="ad",this.photoId=t.photoId,this.ownerNsid=t.nsid,this.adUnit,this.adConfig,"ad"===this.interstitialType&&(this.adUnit=e.config.flickr.moola.positions.interstitials[2],this.adConfig={adUnit:this.adUnit.ad_unit_desktop}),this},subviewConfig:{"gift-pro-view":{placement:"photoPageDownloadInterstitial",requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){let t=this;return e.Promise.all([t.appContext.getModel("person-models",t.ownerNsid),t.appContext.getModel("photo-models",t.photoId)]).then((e=>{t.set("personModel",e[0]),t.set("photoModel",e[1])})).catch((e=>{i.error("Error with fetching person models",{err:e})}))},buildContainer:function(){let t=this.get("personModel"),i=this.get("photoModel"),o=t.getValue("buddyicon").large?t.getValue("buddyicon").large:t.getValue("buddyicon").default,n=t.getValue("displayname"),a=t.getValue("nsid"),s=i.getPhotoLicenseInformation(),l=s?this.intlMessage({intlName:s.key}):"",d=e.URLHelper.generatePersonUrls(t),h="ad"===this.interstitialType;return this.adEventStitch=h?this.appContext.adManager.getHashedAdValue(this.appContext.adManager.getAdPositioning(this.get("container"))):"",this.setContainerWithTemplate("photo-page-download-interstitial",{version:this.interstitialType,adConfig:h?this.adConfig:{},advertisingStitching:this.adEventStitch,displayName:n,pathAlias:d.profile,buddyIcon:o,nsid:a,license:l,learnMoreUrl:s?s.url:"",flickrProLogo:e.config.flickr.urls.assetRoot+"/images/pro/flickr-pro-h1-ic.png",proURL:r.getProLandingPageUrl(r.UTM_ADS_KEEP_FLICKR,{content:"download"})}),this},activate:function(){let e=this.get("container"),t=e.one(".buy-pro-container");return"ad"===this.interstitialType&&(this.appContext.adManager.processAdsOnPage(),this.appContext.adManager.signalAdRequest(this)),t&&t.one(".butt")&&this.registerEventHandler(t.one(".butt").on("click",this.handleFlickrProClick.bind(this))),this.graphContainer=e.one(".progress-container .circular-progress-graph"),this.progressGraph=this.drawProgressGraph(),this.adCountdown(this.adTimerStartValue),this.progressGraph.start(),this},handleFlickrProClick:function(){e.config.win.location=e.url("/account/upgrade/pro")},adCountdown:function(e){let t=this,i=e,r=this.get("container");this.adInterval=setInterval((function(){i>=1?i-=1:(clearInterval(t.adInterval),t.fire("subviewViewEvent","timerEnded"),r.one(".progress-text-container").one(".text")&&(r.one(".progress-text-container").one(".text").getDOMNode().innerText=t.intlMessage({intlName:"photo-page-scrappy.DOWNLOAD_MODAL_COMPLETE"})),r.one(".circular-progress-graph").one(".icon-check")&&r.one(".circular-progress-graph").one(".icon-check").setStyle("display","block"))}),1e3)},drawProgressGraph:function(){return new e.CircleFillGraph({containerElement:this.graphContainer.getDOMNode(),dim:{width:35,height:35},lineWidth:4,backgroundStrokeColor:"#e1e1e1",gradient:[{fillProportion:0,value:"128fdc"},{fillProportion:1,value:"128fdc"}],duration:this.adTimerStartValue,stops:[{durationProportion:1,fillProportion:1,easeFunction:"linear"}],segments:120,className:"progress-icon"})},destructor:function(){this.progressGraph.stop(),this.progressGraph=null}})}),"@VERSION@",{requires:["flickr-view","hermes-template-photo-page-download-interstitial","circle-fill-graph","url-helper","url"],optionalRequires:["hermes-core"],langBundles:["photo-page-scrappy","common","settings","products-flickrpro","interstitials"]});YUI.add("hermes-lang-settings_es-us",(function(e,a){e.Intl.add("hermes/settings","es-US",{SAFE:[{type:0,value:"Seguro"}],MODERATE:[{type:0,value:"Moderado"}],RESTRICTED:[{type:0,value:"Restringido"}],PUBLIC:[{type:0,value:"Público"}],PRIVATE:[{type:0,value:"Privado"}],ANYONE:[{type:0,value:"Cualquier persona"}],FRIENDS:[{type:0,value:"Amigos"}],FAMILY:[{type:0,value:"Familia"}],FRIENDS_AND_FAMILY:[{type:0,value:"Amigos y familia"}],ONLY_YOU:[{type:0,value:"Solo tú"}],PEOPLE_YOU_FOLLOW:[{type:0,value:"Gente a la que sigues"}],ANY_FLICKR_MEMBER:[{type:0,value:"Cualquier miembro de Flickr"}],SOME_RIGHTS_RESERVED:[{type:0,value:"Algunos derechos reservados"}],ALL_RIGHTS_RESERVED:[{type:0,value:"Todos los derechos reservados"}],ATTRIBUTION:[{type:0,value:"Atribución"}],ATTRIBUTION_SHAREALIKE:[{type:0,value:"Atribución-CompartirIgual"}],ATTRIBUTION_NODERIVS:[{type:0,value:"Atribución-SinDerivadas"}],ATTRIBUTION_NONCOMMERCIAL:[{type:0,value:"Atribución-NoComercial "}],ATTRIBUTION_NONCOMMERCIAL_SHAREALIKE:[{type:0,value:"Atribución-NoComercial-CompartirIgual"}],ATTRIBUTION_NONCOMMERCIAL_NODERIVS:[{type:0,value:"Atribución-NoComercial-SinDerivadas"}],NO_COPYRIGHT_RESTRICTIONS:[{type:0,value:"Sin restricciones de derechos de autor conocidas"}],US_GOV_WORK:[{type:0,value:"Trabajo del gobierno de los Estados Unidos"}],PUBLIC_DOMAIN_DEDICATION:[{type:0,value:"Dedicatoria al dominio público (CC0)"}],PUBLIC_DOMAIN_WORK:[{type:0,value:"Obra de dominio público"}],PRIVATE_PENDING_VIDEO:[{type:0,value:"Privado mientras está siendo procesado"}],PRIVATE_FAILED_VIDEO:[{type:0,value:"Privado porque no pudimos procesar este video"}],RESTRICTED_PHOTOS_ONLY:[{type:0,value:"Restringido — Solo fotos"}],SAFETY_LEVELS:[{type:0,value:"Niveles de seguridad"}],SAFE_DESC:[{type:0,value:"Aceptable para una audiencia pública global."}],MODERATE_DESC:[{type:0,value:"Desnudos parciales, como senos y glúteos desnudos. Esto incluye areolas, pezones, tangas, cubre pezones/tapillas o ropa transparente de tipo similar."}],RESTRICTED_DESC:[{type:0,value:"Desnudos frontales completos y actos sexuales. Esto incluye genitales, vello púbico, desnudez frontal completa, imágenes que representan o insinúan actividad sexual, gore, violencia gráfica y temas para adultos. Los videos no pueden incluir este tipo de contenido restringido y se eliminarán si se denuncian."}]})}),"@VERSION@",{requires:["intl"]});YUI.add("hermes-lang-interstitials_es-us",(function(e,a){e.Intl.add("hermes/interstitials","es-US",{ADVERTISEMENTS_HELP_KEEP_FLICKR_FREE:[{type:0,value:"Los anuncios permiten que Flickr sea gratis."}],CLICK_CONTINUE_TO_PHOTOSTREAM:[{type:0,value:'Haz clic en el botón "Continuar" para ir a tu stream de fotos.'}],CTA_CONTINUE_TO_PHOTOSTREAM:[{type:0,value:"Continuar al stream de fotos"}],CTA_PLAN_TO_CHECKOUT:[{type:0,value:"Activa Flickr Pro por "},{type:1,value:"amount"},{type:0,value:"/mes"}],CTA_PLAN_TO_CHECKOUT_WITH_DISCOUNT:[{type:0,value:'Obtén Flickr Pro por <br><span class="strike">'},{type:1,value:"regularCost"},{type:0,value:'</span> <span class="discounted-price">'},{type:1,value:"discountedCost"},{type:0,value:"/mes*</span>"}],WELCOME_PRO_OFFER_DESCRIPTION:[{type:0,value:"Tu cuenta gratuita está limitada a 1,000 cargas públicas de fotos y videos, que se muestran con anuncios."}],WELCOME_PRO_NO_DISCOUNT:[{type:0,value:"Actualiza a Flickr Pro para disfrutar de lo mejor de Flickr."}],WELCOME_PRO_WITH_DISCOUNT:[{type:0,value:'<div class="sub-cta"> ¡Los nuevos miembros de Flickr como tú reciben </div><div class="flickr-pro-discount">&nbsp;'},{type:1,value:"number_symbol"},{type:0,value:"% de descuento para un año de Flickr Pro! </div>"}],WELCOME_TO_FLICKR:[{type:0,value:"¡Bienvenido a Flickr!"}],CONTINUE_WITH_A_FREE_ACCOUNT:[{type:0,value:"Continúa con una cuenta gratis"}],CONTINUE_TO_FLICKR:[{type:0,value:"Continuar a Flickr"}],ADVERTISEMENTS_HELP_KEEP_FLICKR_FREE_BUY_PRO:[{type:0,value:'La publicidad ayuda a hacer que Flickr sea gratis. <a href="'},{type:1,value:"proURL"},{type:0,value:'" target="_new"> Sube de categoría a Flickr Pro para disfrutar de una experiencia sin anuncios </a>'}]})}),"@VERSION@",{requires:["intl"]});YUI.add("photo-engagement-view",(function(e,t){require("hermes-core/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.params=t,t.showFaveCount=t.isResponsiveMobile,this.photoId=t.photoId,this.nsid=t.nsid,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.signinPendingQueue=t.signinPendingQueue,this.isResponsiveMobile=t.isResponsiveMobile,this.photoPrintsHelper=new e.PhotoPrintsHelper(this.appContext),this.signedIn=this.appContext.getViewer().signedIn,this.photoCardHelper=new e.PhotoCardHelper(this.appContext),this.curationHelper=new e.CurationHelper(this.appContext,{view:this}),this.downloadLink="",this.downloadInterstitialModal,t.subviewParams={"like-engagement-item-view":{photoId:t.photoId,showCount:!1,size:"medium",isPadded:!0}},this},subviewConfig:{"fave-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,hideWhoFaved:!0,additionalViewClasses:["engagement-item"],disabled:function(){return this.appContext.flipper.isFlipped("enable-likes")}},"like-engagement-item-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,additionalViewClasses:["engagement-item"],theme:"light",disabled:function(){return!this.appContext.flipper.isFlipped("enable-likes")}},"photo-well-scrappy-edit-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,additionalViewClasses:function(){return this.appContext.flipper.isFlipped("enable-photo-page-lightbox-updates")?["engagement-item","enable-photo-page-lightbox-updates"]:["engagement-item"]}},"fluid-share-photo-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,additionalViewClasses:["engagement-item"],theme:"light"},"print-button-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,additionalViewClasses:["engagement-item"]}},loadState:function(){return this.appContext.getModel("photo-models",this.photoId).then((e=>{var t=e.getValue("owner");return this.set("photo",e),this.downloadButtonEnabled=!1,e.getValue("isVideo")?(this.appContext.flipper.isFlipped("disable-video-playback")?this.downloadButtonEnabled=!1:(this.appContext.flipper.isFlipped("enable-album-download")&&(this.downloadButtonEnabled=e.getValue("engagement").getValue("canDownload")),t.getValue("isMe")&&(this.downloadButtonEnabled=!0)),this.downloadLink="/video_download.gne?id="+e.getValue("id")):(this.downloadButtonEnabled=!0,this.downloadLink=e.getValue("url")+"/sizes/l/"),this.appContext.getModel("person-relationship-models",e.getValue("owner").getValue("nsid"))})).then((e=>{this.set("relationshipModel",e)}))},buildContainer:function(){var e,t=this.get("photo"),o=t.getValue("owner"),n=this.get("container"),i=this.photoCardHelper.convertPhotoModel(t);return e={"share-view":this.subviews["fluid-share-photo-view"]?this.subviews["fluid-share-photo-view"].get("container"):"",photoId:t.getValue("id"),ownerId:t.getValue("owner").getValue("id"),isVideo:t.getValue("isVideo"),viewerIsOwner:o.getValue("isMe"),downloadingAvailable:this.downloadButtonEnabled,downloadLink:this.downloadLink,showPrintButton:this.photoPrintsHelper.canPrintPhoto(t,this.get("relationshipModel")),photoItem:i,signedIn:this.signedIn,faveCount:t.getValue("engagement").getValue("faveCount"),commentCount:t.getValue("engagement").getValue("commentCount"),isResponsiveMobile:this.isResponsiveMobile},this.appContext.forceServerRender&&(e.downloadItems=this.getDownloadMenuItems()),this.setContainerWithTemplate("photo-engagement",e),this.isResponsiveMobile&&n.addClass("responsive-mobile"),this},activate:function(){var t=this,o=(this.get("photo").getValue("license"),this.get("container"));if(this.engagementModel=this.get("photo").getValue("engagement"),this.signinPendingQueue&&this.signinPendingQueue.length>0)for(var n=this.signinPendingQueue,i=0;i<n.length;i++)"download"===n[i].key&&n[i].value&&n[i].value.id===this.photoId&&this.downloadItem(n[i].value.imageUrl);return this.engagementModel.getValue("canDownload")&&this.registerEventHandler(e.one("body").delegate("click",(function(e){t.canShowDownloadInterstitial()?t.showDownloadIntersitialModal(e):t.handleDownloadItemClick(e)}),".sizes li a.download-image-size")),this.attachKeyEvent("down:68",this.handleDownloadMenuButtonClick.bind(this)),this.registerEventHandler(o.delegate("click",this.handleDownloadMenuButtonClick.bind(this),".download a")),this.curateNode=o.one(".engagement-item.curate"),this.curateNode&&this.registerEventHandler(this.curateNode.on("click",this.handleCurateClick.bind(this))),this.commentNode=o.one(".engagement-item.comment"),this.commentNode&&(this.commentTextNode=this.commentNode.one(".engagement-count"),this.registerEventHandler(this.commentNode.on("click",this.showCommentsModal.bind(this)))),this.faveTextNode=o.one(".fave-count"),this.registerEventHandler(this.engagementModel.on("valuesChanged",this.handleEngagementModelValuesChanged.bind(this))),this},canShowDownloadInterstitial:function(){let e=this.appContext.viewportData.getWidth();return!this.get("photo").getValue("owner").getValue("isMe")&&(window&&window.innerWidth&&window.innerWidth!==e&&(e+=this.appContext.viewportData.scrollbarWidth),e&&e>700&&this.appContext.adManager.canShowAdWithPhoto(this.get("photo")))},showDownloadIntersitialModal:function(t){let o=this;t.preventDefault(),this.downloadInterstitialModal=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!1,dismissOnActionClick:!1,showBodyLines:!1,showCancelButton:!1,showFooter:!1,showCancelX:!0,subview:new e.Views["photo-page-download-interstitial-view"]({appContext:o.appContext,nsid:this.nsid,photoId:this.photoId}),width:900,minWidth:650,height:540,fullWindow:!1,classList:"download-interstitial-modal"}),this.downloadInterstitialModal.show(),this.downloadInterstitialModal.on("timerEnded",(function(){o.handleDownloadItemClick(t)}))},getDownloadMenuItems:function(t){var o,n=this.get("photo"),i=e.clone(n.getValue("sizes")),a=[],s=n.getValue("engagement").getValue("canDownload"),l=this;for(["q","sq"].some((function(e){if(i[e])return i[e].label=l.intlMessage({intlName:"photo-page-scrappy.SQUARE"}),a.push(i[e])})),["w","n","s","t"].some((function(e){if(i[e])return i[e].label=l.intlMessage({intlName:"photo-page-scrappy.SMALL"}),a.push(i[e])})),["c","z","m"].some((function(e){if(i[e])return i[e].label=l.intlMessage({intlName:"photo-page-scrappy.MEDIUM"}),a.push(i[e])})),["k","h","l"].some((function(e){if(i[e])return i[e].label=l.intlMessage({intlName:"photo-page-scrappy.LARGE"}),a.push(i[e])})),["6k","5k","4k","3k"].some((function(e){if(i[e])return i[e].label=l.intlMessage({intlName:"common.XLARGE"}),a.push(i[e])})),i.o&&(i.o.label=this.intlMessage({intlName:"photo-page-scrappy.ORIGINAL"}),a.push(i.o)),o=0;o<a.length;o++)a[o].url=a[o].displayUrl.replace(/^(.+)(\..+)$/,"$1_d$2");return this.templates("scrappy-download-menu")({photoURL:n.getValue("url"),sizes:a,showDownloadSizes:s})},createDownloadDialog:function(t){var o=this.get("container");this.downloadMenu&&(this.downloadMenu.close(),this.downloadMenu=null),this.downloadMenu=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,preferTop:!0,showDropArrow:!0,anchorOffsetVertical:5,width:200,anchorElement:o.one(".download"),htmlMessage:t,closeOnScroll:!1,classList:"download-dialog-tooltip",autoSizeToContent:!0}),this.downloadMenu.show()},handleDownloadMenuButtonClick:function(e){var t=this.get("photo");if(this.downloadButtonEnabled)if(t.getValue("isVideo")){if(this.appContext.flipper.isFlipped("enable-album-download"))e.preventDefault(),this.downloadItem(this.downloadLink);else if(!t.getValue("owner").getValue("isMe"))return e.preventDefault(),!1}else e.halt(),this.createDownloadDialog(this.getDownloadMenuItems());else e.preventDefault()},handleDownloadItemClick:function(t){t.preventDefault(),this.downloadItem(t.currentTarget.getAttribute("href"));let o=t.currentTarget;if(o){let t=o.getAttribute("data-size"),n=o.getAttribute("data-res-width"),i=o.getAttribute("data-res-height");t&&n&&i&&e.Snowplough.sendSelfDescribingEvent({schema:e.Snowplough.SCHEMAS.DOWNLOAD,data:{photoId:[parseInt(this.get("photo").getValue("id"),10)],size:t.toLowerCase(),width:parseInt(n,10),height:parseInt(i,10),license:parseInt(this.get("photo").getValue("license"),10),ownerNsid:this.get("photo").getValue("owner").id,isBatch:!1}},e.Snowplough.getPhotoContextFromModel(this.get("photo")))}!this.canShowDownloadInterstitial()&&this.downloadMenu&&(this.downloadMenu.close(),this.downloadMenu=null)},downloadItem:function(e){document.location=e},handleCurateClick:function(){var t=this,o=this.get("photo").getValue("isOwner");"fluid-droparound-view"===this.curationHelper.showAddToCuration({photoId:this.get("photo").getValue("id"),showAlbums:o,showGalleries:!o,anchorNode:this.curateNode}).name&&(this.fire("menuOpened"),this.curationHelper.on("curateDroparoundClosed",(function(){t.fire("menuClosed"),t.curateNode.removeClass("active")})),this.curateNode.addClass("active")),e.Snowplough.sendStructuredEvent({category:"photopageinteractions",action:"curateClick"},e.Snowplough.getPhotoContextFromModel(this.get("photo")))},showCommentsModal:function(){var t={appContext:this.appContext,photoId:this.photoId,isScrollable:!0,hasHeader:!0},o=new e.ModalDroparoundHelper(this.appContext,{useViewportType:!1,containerType:"modal",configs:{common:{subviewName:"photo-comments-view",subviewParams:t},modal:{height:550,flexLayout:!0}}});this.registerEventHandler(o.on("close",(()=>{e.fire("photoCommentModalClosed",{photoId:this.photoId})}))),this.registerEventHandler(e.on("addComment:showingSignupModal",(()=>{o.close()}))),o.show()},handleEngagementModelValuesChanged:function(t){var o,n;t.commentCount?(o=t.commentCount.newVal,this.commentTextNode&&(this.commentTextNode.set("text",e.IntlNumber.format(o,this.appContext.lang,1)),this.commentTextNode.toggleClass("hidden",0===o))):t.faveCount&&(n=t.faveCount.newVal,this.faveTextNode&&(this.faveTextNode.set("text",e.IntlNumber.format(n,this.appContext.lang,1)),this.faveTextNode.toggleClass("hidden",0===n)))}})}),"@VERSION@",{requires:["flickr-view","hermes-template-photo-engagement","hermes-template-scrappy-download-menu","signup-modal-view","fluid-share-photo-view","fluid-droparound-view","print-button-view","photo-comments-view","better-throttle","photo-prints-helper","photo-card-helper","fluid-modal-view","photo-page-download-interstitial-view"],optionalRequires:["hermes-core"],optional:["photo-models"],langBundles:["common","photo-page-scrappy","comments"]});YUI.add("flickr-route",(function(r,e){var t=require("hermes-core/flog")(e),i=require("hermes-core/type-validator");r.Routes=r.Routes||{},r.FlickrRoute=function(r){this.appContext=r},r.FlickrRoute.prototype={run:function(){},setRouteDataOnHistory:function(e,t){return r.HistoryHelper.setData(this.name,e,t)},getRouteDataFromHistory:function(e){return r.HistoryHelper.getData(this.name,e)},getRouteMetaValue:function(r,e){return this.appContext.routeConfig.meta?e?this.appContext.routeConfig.meta[r]?this.appContext.routeConfig.meta[r]:e:this.appContext.routeConfig.meta[r]?this.appContext.routeConfig.meta[r]:null:null},displayServerErrorOrClientRedirect:function(e,t,i){return YUI.Env.isServer?this.displayRouteErrors(e,new r.RouteError(404,t)):r.Promise.resolve({redirect:i||e.url})},detectRouteErrors:function(){var e=r.Array(arguments);return e.filter((function(e,t){return e instanceof r.RouteError})).sort((function(r,e){return r.type-e.type}))},displayRouteErrors:function(e,t){var i=r.Lang.isArray(t)?t[0]:t;return r.Promise.resolve(this["display"+i.type+"Error"](e,i))},display500Error:function(e,i){var a,s,o;return a={view:"error-500-page-view",params:{},headers:{statusCode:500}},(r.config.flickr.error.show_debugging_info||e.isPossiblyAdminUser||this.appContext&&this.appContext.auth&&this.appContext.auth.isPossiblyAdminUser)&&(a.params.source="flickrRoute#display500Error",a.params.message=i.message,a.params.stack=i.stack,a.params.apiMethod=i.apiMethod),YUI.Env.isServer||(a.params.message=i.message,a.params.apiMethod=i.apiMethod),e.id&&(a.params.requestID=e.id),i&&"SiteAuth"===i.type&&(i.redirect?(s=YUI.Env.isServer?e.protocol+"://"+e.hostname+e.originalUrl:e.url,o=r.url("/siteauth/?redirect_url="+encodeURIComponent(s)),YUI.Env.isServer&&t.info("Redirecting to siteauth"),a={redirect:o}):YUI.Env.isServer&&(a.params.siteAuthFailure=!0)),void 0===a.redirect?t.info("render",{status:500,req:e,err:i,isBot:this.appContext.getUA().isBot}):t.info("redirect",{status:302,req:e,location:a.redirect,isBot:this.appContext.getUA().isBot}),a},display303Error:function(r,e){return{redirect:e.options.redirect,headers:{statusCode:303}}},display403Error:function(r,e){return this.displayStandardErrorPage(r,e,403)},display404Error:function(r,e){return e=e||new Error("404"),t.info("render",{status:404,url:r.url,err:e,isBot:this.appContext.getUA().isBot}),this.displayStandardErrorPage(r,e,404)},display410Error:function(r,e){return this.displayStandardErrorPage(r,e,410)},displayStandardErrorPage:function(e,t,i){var a;return t=t||{},a={view:"fluid-error-page-view",params:{statusCode:i,url:e.url,message:t.message,catchAll:t.catchAll||!1},headers:{statusCode:i}},t.data&&(a.params=r.merge(a.params,t.data)),(r.config.flickr.error.show_debugging_info||e.isPossiblyAdminUser||this.appContext&&this.appContext.auth&&this.appContext.auth.isPossiblyAdminUser)&&(a.params.source="flickrRoute#display"+i+"Error",a.params.message=t.message),e.id&&(a.params.requestID=e.id),a},getPageNumber:function(r,e){var t=parseInt(r.params[e||"page_number"],10);return(isNaN(t)||t<=1)&&(t=1),t},getNSIDOrPathAlias:function(r){var e;return i.nsid(r)?e=r:i.pathAlias(r)?e={pathAlias:r}:t.warn("Couldn't identify "+r+" as an nsid or path alias."),e}},r.RouteError=function(r,e,t){this.type=r,this.message=e||"",this.data=t||{}}}),"@VERSION@",{requires:["flickr-promise","moment","url","history-helper"],optionalRequires:["hermes-core"]});YUI.add("seo",(function(e,t){e.Seo={appContext:{},stripTags:function(e){return e?String(e).replace(/<\/?[^>]+>/g,""):""},collapseWhitespace:function(e){return e.trim().replace(/\s+/g," ")},decodeEntities:function(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&nbsp;/g," ")},cleanText:function(e){return this.collapseWhitespace(this.decodeEntities(this.stripTags(e)))},getSEOTitleForPhoto:function(e){var t=this.cleanText(e.getValue("title")),l=this.cleanText(e.getValue("description")),n=this.cleanText(e.getValue("owner").getValue("displayname")),g=70-(t.length+"| Flickr".length+5);return t.length>=50?t.slice(0,58)+(t.length<58?" ":"… "):t.length>20&&t.length<50?l.length>20?t+" | "+l.slice(0,g)+(l.length<g?" ":"… "):l.length>0?t+" | "+l.slice(0,g)+(l.length<g?" ":"… ")+"| "+n+" ":t+" | "+n+" ":t.length<=20&&t.length>0?l.length>50?t+" | "+l.slice(0,g)+(l.length<g?" ":"… "):l.length>0?t+" | "+l.slice(0,g)+(l.length<g?" ":"… ")+"| "+n+" ":t+" | "+n+" ":l.length>50?l.slice(0,g)+(l.length<g?" ":"… "):l.length>0?l.slice(0,g)+(l.length<g?" ":"… ")+"| "+n+" ":"Untitled | "+n+" "},generateSEODescriptionForPhoto:function(e,t,l,n,g){var i=e.getValue("og:title"),h=e.getValue("og:description"),c="";return"Untitled"===i&&(i=n),h.length>120?c=h.slice(0,120)+(h.length<120?" ":"… ")+l+" "+g+".":h.length>60&&h.length<120?c=h+("."===h.slice(h.length-1,h.length)?" ":". ")+i.slice(0,40)+(i.length<40?" ":"… ")+l+" "+g+".":h.length<=60&&(c=i+("."===i.slice(i.length-1,i.length)?" ":". ")+h.slice(0,160-i.length)+(h.length<160-i.length?" ":"… ")+l+" "+g+"."),c}}}),"@VERSION@",{requires:[]});YUI.add("page-categorizations-models",(function(e){function r(e){r.superclass.constructor.call(this,e)}e.Models[this.name]=r,e.extend(r,e.FlickrModelRegistry,{name:this.name,remote:{read:function(r){return e.ModelFetchers["flickr-pageCategorizer"].run(r,this.appContext)}},attributes:{id:{},categories:{}}})}),"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-pageCategorizer-fetcher"]});YUI.add("flickr-pageCategorizer-fetcher",(function(e,r){"use strict";e.namespace("ModelFetchers")["flickr-pageCategorizer"]={run:function(s,o){const t=this;return e.Snowplough.sendSelfDescribingEvent({schema:e.Snowplough.SCHEMAS.PAGE_CATEGORIZATIONS,data:{photoId:[parseInt(s.id,10)],status:"requested"}}),new e.FlickrPromise({apiResponse:o.callAPI("flickr.ads.checkPhotoClassification",this._processParams(s),!0),pageCategorizationsModelRegistry:o.getModelRegistry("page-categorizations-models")}).then((function(e){return t._processResponse(e,s)}),e.FetcherErrorLogger(r))},_processParams:function(e){return{photo_id:e.id}},_processResponse:function(e,r){var s=e.apiResponse,o=e.pageCategorizationsModelRegistry,t=r.id;delete s.stat;var i={id:t,categories:s};return o.addOrUpdate(i),i}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["page-categorizations-models"]});